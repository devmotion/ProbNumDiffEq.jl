<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Second Order ODEs and Energy Preservation · ProbNumDiffEq.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ProbNumDiffEq.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Introduction to ODE Filters</a></li><li class="is-active"><a class="tocitem" href>Second Order ODEs and Energy Preservation</a><ul class="internal"><li><a class="tocitem" href="#Simulating-the-Hénon-Heiles-system"><span>Simulating the Hénon-Heiles system</span></a></li><li><a class="tocitem" href="#Energy-preservation"><span>Energy preservation</span></a></li></ul></li><li><a class="tocitem" href="../dae/">Differential Algebraic Equations</a></li></ul></li><li><a class="tocitem" href="../solvers/">Solvers and Options</a></li><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../filtering/">Filtering and Smoothing</a></li><li><a class="tocitem" href="../implementation/">Implementation via OrdinaryDiffEq.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Second Order ODEs and Energy Preservation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Second Order ODEs and Energy Preservation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/main/docs/src/dynamical_odes.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Second-Order-ODEs-and-Energy-Preservation"><a class="docs-heading-anchor" href="#Second-Order-ODEs-and-Energy-Preservation">Second Order ODEs and Energy Preservation</a><a id="Second-Order-ODEs-and-Energy-Preservation-1"></a><a class="docs-heading-anchor-permalink" href="#Second-Order-ODEs-and-Energy-Preservation" title="Permalink"></a></h1><p>In this tutorial we consider an <em>energy-preserving</em>, physical dynamical system, given by a <em>second-order</em> ODE.</p><h4 id="TL;DR:"><a class="docs-heading-anchor" href="#TL;DR:">TL;DR:</a><a id="TL;DR:-1"></a><a class="docs-heading-anchor-permalink" href="#TL;DR:" title="Permalink"></a></h4><ol><li>To <em>efficiently</em> solve second-order ODEs, just define the problem as a <code>SecondOrderODEProblem</code>.</li><li>To preserve constant quantities, use the <code>ManifoldUpdate</code> callback; same syntax as <a href="https://diffeq.sciml.ai/stable/features/callback_library/#Manifold-Conservation-and-Projection">DiffEqCallback.jl&#39;s <code>ManifoldProjection</code></a>.</li></ol><h2 id="Simulating-the-Hénon-Heiles-system"><a class="docs-heading-anchor" href="#Simulating-the-Hénon-Heiles-system">Simulating the Hénon-Heiles system</a><a id="Simulating-the-Hénon-Heiles-system-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-Hénon-Heiles-system" title="Permalink"></a></h2><p>The Hénon-Heiles model describes the motion of a star around a galactic center, restricted to a plane. It is given by a second-order ODE</p><p class="math-container">\[\begin{aligned}
\ddot{x} &amp;= - x - 2 x y \\
\ddot{y} &amp;= y^2 - y - x^2.
\end{aligned}\]</p><p>Our goal is to numerically simulate this system on a time span <span>$t \in [0, T]$</span>, starting with initial values <span>$x(0)=0$</span>, <span>$y(0) = 0.1$</span>, <span>$\dot{x}(0) = 0.5$</span>, <span>$\dot{y}(0) = 0$</span>.</p><h3 id="Transforming-the-problem-into-a-first-order-ODE"><a class="docs-heading-anchor" href="#Transforming-the-problem-into-a-first-order-ODE">Transforming the problem into a first-order ODE</a><a id="Transforming-the-problem-into-a-first-order-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Transforming-the-problem-into-a-first-order-ODE" title="Permalink"></a></h3><p>A very common approach is to first transform the problem into a first-order ODE by introducing a new variable</p><p class="math-container">\[u = [dx,dy,x,y],\]</p><p>to obtain</p><p class="math-container">\[\begin{aligned}
\dot{u}_1(t) &amp;= - u_3 - 2 u_3 u_4 \\
\dot{u}_2(t) &amp;= u_4^2 - u_4 - u_4^2 \\
\dot{u}_3(t) &amp;= u_1 \\
\dot{u}_4(t) &amp;= u_2.
\end{aligned}\]</p><p>This first-order ODE can then be solved using any conventional ODE solver - including our <code>EK1</code>:</p><pre><code class="language-julia hljs">using ProbNumDiffEq, Plots

function Hénon_Heiles(du, u, p, t)
    du[1] = -u[3] - 2 * u[3] * u[4]
    du[2] = u[4]^2 - u[4] - u[3]^2
    du[3] = u[1]
    du[4] = u[2]
end
u0, du0 = [0.0, 0.1], [0.5, 0.0]
tspan = (0.0, 100.0)
prob = ODEProblem(Hénon_Heiles, [du0; u0], tspan)
sol = solve(prob, EK1());
plot(sol, vars=(3, 4)) # where `vars=(3,4)` is used to plot x agains y</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip270">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip270)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip271">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip270)" d="
M194.422 1486.45 L2352.76 1486.45 L2352.76 47.2441 L194.422 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip272">
    <rect x="194" y="47" width="2159" height="1440"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  402.713,1486.45 402.713,47.2441 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  835.22,1486.45 835.22,47.2441 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1267.73,1486.45 1267.73,47.2441 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1700.24,1486.45 1700.24,47.2441 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2132.74,1486.45 2132.74,47.2441 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1486.45 2352.76,1486.45 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  402.713,1486.45 402.713,1467.55 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  835.22,1486.45 835.22,1467.55 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1267.73,1486.45 1267.73,1467.55 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.24,1486.45 1700.24,1467.55 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2132.74,1486.45 2132.74,1467.55 
  "/>
<path clip-path="url(#clip270)" d="M348.998 1532.02 L378.674 1532.02 L378.674 1535.95 L348.998 1535.95 L348.998 1532.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M398.766 1517.37 Q395.155 1517.37 393.326 1520.93 Q391.521 1524.47 391.521 1531.6 Q391.521 1538.71 393.326 1542.27 Q395.155 1545.82 398.766 1545.82 Q402.4 1545.82 404.206 1542.27 Q406.035 1538.71 406.035 1531.6 Q406.035 1524.47 404.206 1520.93 Q402.4 1517.37 398.766 1517.37 M398.766 1513.66 Q404.576 1513.66 407.632 1518.27 Q410.71 1522.85 410.71 1531.6 Q410.71 1540.33 407.632 1544.94 Q404.576 1549.52 398.766 1549.52 Q392.956 1549.52 389.877 1544.94 Q386.822 1540.33 386.822 1531.6 Q386.822 1522.85 389.877 1518.27 Q392.956 1513.66 398.766 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M418.928 1542.97 L423.812 1542.97 L423.812 1548.85 L418.928 1548.85 L418.928 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M446.845 1518.36 L435.039 1536.81 L446.845 1536.81 L446.845 1518.36 M445.618 1514.29 L451.497 1514.29 L451.497 1536.81 L456.428 1536.81 L456.428 1540.7 L451.497 1540.7 L451.497 1548.85 L446.845 1548.85 L446.845 1540.7 L431.243 1540.7 L431.243 1536.19 L445.618 1514.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M782.547 1532.02 L812.223 1532.02 L812.223 1535.95 L782.547 1535.95 L782.547 1532.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M832.315 1517.37 Q828.704 1517.37 826.876 1520.93 Q825.07 1524.47 825.07 1531.6 Q825.07 1538.71 826.876 1542.27 Q828.704 1545.82 832.315 1545.82 Q835.95 1545.82 837.755 1542.27 Q839.584 1538.71 839.584 1531.6 Q839.584 1524.47 837.755 1520.93 Q835.95 1517.37 832.315 1517.37 M832.315 1513.66 Q838.126 1513.66 841.181 1518.27 Q844.26 1522.85 844.26 1531.6 Q844.26 1540.33 841.181 1544.94 Q838.126 1549.52 832.315 1549.52 Q826.505 1549.52 823.427 1544.94 Q820.371 1540.33 820.371 1531.6 Q820.371 1522.85 823.427 1518.27 Q826.505 1513.66 832.315 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M852.477 1542.97 L857.362 1542.97 L857.362 1548.85 L852.477 1548.85 L852.477 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M871.574 1544.91 L887.894 1544.91 L887.894 1548.85 L865.949 1548.85 L865.949 1544.91 Q868.611 1542.16 873.195 1537.53 Q877.801 1532.88 878.982 1531.53 Q881.227 1529.01 882.107 1527.27 Q883.01 1525.51 883.01 1523.82 Q883.01 1521.07 881.065 1519.33 Q879.144 1517.6 876.042 1517.6 Q873.843 1517.6 871.389 1518.36 Q868.959 1519.13 866.181 1520.68 L866.181 1515.95 Q869.005 1514.82 871.459 1514.24 Q873.912 1513.66 875.949 1513.66 Q881.32 1513.66 884.514 1516.35 Q887.709 1519.03 887.709 1523.52 Q887.709 1525.65 886.898 1527.57 Q886.111 1529.47 884.005 1532.07 Q883.426 1532.74 880.324 1535.95 Q877.223 1539.15 871.574 1544.91 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M1245.11 1517.37 Q1241.5 1517.37 1239.67 1520.93 Q1237.87 1524.47 1237.87 1531.6 Q1237.87 1538.71 1239.67 1542.27 Q1241.5 1545.82 1245.11 1545.82 Q1248.75 1545.82 1250.55 1542.27 Q1252.38 1538.71 1252.38 1531.6 Q1252.38 1524.47 1250.55 1520.93 Q1248.75 1517.37 1245.11 1517.37 M1245.11 1513.66 Q1250.92 1513.66 1253.98 1518.27 Q1257.06 1522.85 1257.06 1531.6 Q1257.06 1540.33 1253.98 1544.94 Q1250.92 1549.52 1245.11 1549.52 Q1239.3 1549.52 1236.22 1544.94 Q1233.17 1540.33 1233.17 1531.6 Q1233.17 1522.85 1236.22 1518.27 Q1239.3 1513.66 1245.11 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M1265.27 1542.97 L1270.16 1542.97 L1270.16 1548.85 L1265.27 1548.85 L1265.27 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M1290.34 1517.37 Q1286.73 1517.37 1284.9 1520.93 Q1283.1 1524.47 1283.1 1531.6 Q1283.1 1538.71 1284.9 1542.27 Q1286.73 1545.82 1290.34 1545.82 Q1293.98 1545.82 1295.78 1542.27 Q1297.61 1538.71 1297.61 1531.6 Q1297.61 1524.47 1295.78 1520.93 Q1293.98 1517.37 1290.34 1517.37 M1290.34 1513.66 Q1296.15 1513.66 1299.21 1518.27 Q1302.29 1522.85 1302.29 1531.6 Q1302.29 1540.33 1299.21 1544.94 Q1296.15 1549.52 1290.34 1549.52 Q1284.53 1549.52 1281.45 1544.94 Q1278.4 1540.33 1278.4 1531.6 Q1278.4 1522.85 1281.45 1518.27 Q1284.53 1513.66 1290.34 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M1678.42 1517.37 Q1674.81 1517.37 1672.98 1520.93 Q1671.17 1524.47 1671.17 1531.6 Q1671.17 1538.71 1672.98 1542.27 Q1674.81 1545.82 1678.42 1545.82 Q1682.05 1545.82 1683.86 1542.27 Q1685.69 1538.71 1685.69 1531.6 Q1685.69 1524.47 1683.86 1520.93 Q1682.05 1517.37 1678.42 1517.37 M1678.42 1513.66 Q1684.23 1513.66 1687.28 1518.27 Q1690.36 1522.85 1690.36 1531.6 Q1690.36 1540.33 1687.28 1544.94 Q1684.23 1549.52 1678.42 1549.52 Q1672.61 1549.52 1669.53 1544.94 Q1666.47 1540.33 1666.47 1531.6 Q1666.47 1522.85 1669.53 1518.27 Q1672.61 1513.66 1678.42 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M1698.58 1542.97 L1703.46 1542.97 L1703.46 1548.85 L1698.58 1548.85 L1698.58 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M1717.68 1544.91 L1734 1544.91 L1734 1548.85 L1712.05 1548.85 L1712.05 1544.91 Q1714.71 1542.16 1719.3 1537.53 Q1723.9 1532.88 1725.09 1531.53 Q1727.33 1529.01 1728.21 1527.27 Q1729.11 1525.51 1729.11 1523.82 Q1729.11 1521.07 1727.17 1519.33 Q1725.25 1517.6 1722.15 1517.6 Q1719.95 1517.6 1717.49 1518.36 Q1715.06 1519.13 1712.28 1520.68 L1712.28 1515.95 Q1715.11 1514.82 1717.56 1514.24 Q1720.02 1513.66 1722.05 1513.66 Q1727.42 1513.66 1730.62 1516.35 Q1733.81 1519.03 1733.81 1523.52 Q1733.81 1525.65 1733 1527.57 Q1732.21 1529.47 1730.11 1532.07 Q1729.53 1532.74 1726.43 1535.95 Q1723.33 1539.15 1717.68 1544.91 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M2109.88 1517.37 Q2106.27 1517.37 2104.44 1520.93 Q2102.64 1524.47 2102.64 1531.6 Q2102.64 1538.71 2104.44 1542.27 Q2106.27 1545.82 2109.88 1545.82 Q2113.52 1545.82 2115.32 1542.27 Q2117.15 1538.71 2117.15 1531.6 Q2117.15 1524.47 2115.32 1520.93 Q2113.52 1517.37 2109.88 1517.37 M2109.88 1513.66 Q2115.69 1513.66 2118.75 1518.27 Q2121.83 1522.85 2121.83 1531.6 Q2121.83 1540.33 2118.75 1544.94 Q2115.69 1549.52 2109.88 1549.52 Q2104.07 1549.52 2101 1544.94 Q2097.94 1540.33 2097.94 1531.6 Q2097.94 1522.85 2101 1518.27 Q2104.07 1513.66 2109.88 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M2130.05 1542.97 L2134.93 1542.97 L2134.93 1548.85 L2130.05 1548.85 L2130.05 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M2157.96 1518.36 L2146.16 1536.81 L2157.96 1536.81 L2157.96 1518.36 M2156.74 1514.29 L2162.62 1514.29 L2162.62 1536.81 L2167.55 1536.81 L2167.55 1540.7 L2162.62 1540.7 L2162.62 1548.85 L2157.96 1548.85 L2157.96 1540.7 L2142.36 1540.7 L2142.36 1536.19 L2156.74 1514.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,1440.09 2352.76,1440.09 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,1133.61 2352.76,1133.61 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,827.135 2352.76,827.135 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,520.657 2352.76,520.657 
  "/>
<polyline clip-path="url(#clip272)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,214.178 2352.76,214.178 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1486.45 194.422,47.2441 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1440.09 213.32,1440.09 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1133.61 213.32,1133.61 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,827.135 213.32,827.135 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,520.657 213.32,520.657 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,214.178 213.32,214.178 
  "/>
<path clip-path="url(#clip270)" d="M50.9921 1440.54 L80.6679 1440.54 L80.6679 1444.48 L50.9921 1444.48 L50.9921 1440.54 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M100.76 1425.89 Q97.1493 1425.89 95.3206 1429.45 Q93.515 1433 93.515 1440.13 Q93.515 1447.23 95.3206 1450.8 Q97.1493 1454.34 100.76 1454.34 Q104.395 1454.34 106.2 1450.8 Q108.029 1447.23 108.029 1440.13 Q108.029 1433 106.2 1429.45 Q104.395 1425.89 100.76 1425.89 M100.76 1422.19 Q106.571 1422.19 109.626 1426.79 Q112.705 1431.38 112.705 1440.13 Q112.705 1448.85 109.626 1453.46 Q106.571 1458.04 100.76 1458.04 Q94.9502 1458.04 91.8715 1453.46 Q88.816 1448.85 88.816 1440.13 Q88.816 1431.38 91.8715 1426.79 Q94.9502 1422.19 100.76 1422.19 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M120.922 1451.49 L125.807 1451.49 L125.807 1457.37 L120.922 1457.37 L120.922 1451.49 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M148.839 1426.89 L137.033 1445.33 L148.839 1445.33 L148.839 1426.89 M147.612 1422.81 L153.492 1422.81 L153.492 1445.33 L158.422 1445.33 L158.422 1449.22 L153.492 1449.22 L153.492 1457.37 L148.839 1457.37 L148.839 1449.22 L133.237 1449.22 L133.237 1444.71 L147.612 1422.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M53.0754 1134.06 L82.7512 1134.06 L82.7512 1138 L53.0754 1138 L53.0754 1134.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M102.844 1119.41 Q99.2326 1119.41 97.4039 1122.98 Q95.5984 1126.52 95.5984 1133.65 Q95.5984 1140.75 97.4039 1144.32 Q99.2326 1147.86 102.844 1147.86 Q106.478 1147.86 108.283 1144.32 Q110.112 1140.75 110.112 1133.65 Q110.112 1126.52 108.283 1122.98 Q106.478 1119.41 102.844 1119.41 M102.844 1115.71 Q108.654 1115.71 111.709 1120.31 Q114.788 1124.9 114.788 1133.65 Q114.788 1142.37 111.709 1146.98 Q108.654 1151.56 102.844 1151.56 Q97.0335 1151.56 93.9549 1146.98 Q90.8993 1142.37 90.8993 1133.65 Q90.8993 1124.9 93.9549 1120.31 Q97.0335 1115.71 102.844 1115.71 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M123.006 1145.01 L127.89 1145.01 L127.89 1150.89 L123.006 1150.89 L123.006 1145.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M142.103 1146.96 L158.422 1146.96 L158.422 1150.89 L136.478 1150.89 L136.478 1146.96 Q139.14 1144.2 143.723 1139.57 Q148.33 1134.92 149.51 1133.58 Q151.755 1131.06 152.635 1129.32 Q153.538 1127.56 153.538 1125.87 Q153.538 1123.12 151.593 1121.38 Q149.672 1119.64 146.57 1119.64 Q144.371 1119.64 141.918 1120.41 Q139.487 1121.17 136.709 1122.72 L136.709 1118 Q139.533 1116.87 141.987 1116.29 Q144.441 1115.71 146.478 1115.71 Q151.848 1115.71 155.042 1118.39 Q158.237 1121.08 158.237 1125.57 Q158.237 1127.7 157.427 1129.62 Q156.64 1131.52 154.533 1134.11 Q153.955 1134.78 150.853 1138 Q147.751 1141.19 142.103 1146.96 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M101.246 812.934 Q97.6354 812.934 95.8067 816.498 Q94.0012 820.04 94.0012 827.17 Q94.0012 834.276 95.8067 837.841 Q97.6354 841.382 101.246 841.382 Q104.881 841.382 106.686 837.841 Q108.515 834.276 108.515 827.17 Q108.515 820.04 106.686 816.498 Q104.881 812.934 101.246 812.934 M101.246 809.23 Q107.057 809.23 110.112 813.836 Q113.191 818.42 113.191 827.17 Q113.191 835.896 110.112 840.503 Q107.057 845.086 101.246 845.086 Q95.4363 845.086 92.3576 840.503 Q89.3021 835.896 89.3021 827.17 Q89.3021 818.42 92.3576 813.836 Q95.4363 809.23 101.246 809.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M121.408 838.535 L126.293 838.535 L126.293 844.415 L121.408 844.415 L121.408 838.535 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M146.478 812.934 Q142.867 812.934 141.038 816.498 Q139.232 820.04 139.232 827.17 Q139.232 834.276 141.038 837.841 Q142.867 841.382 146.478 841.382 Q150.112 841.382 151.918 837.841 Q153.746 834.276 153.746 827.17 Q153.746 820.04 151.918 816.498 Q150.112 812.934 146.478 812.934 M146.478 809.23 Q152.288 809.23 155.343 813.836 Q158.422 818.42 158.422 827.17 Q158.422 835.896 155.343 840.503 Q152.288 845.086 146.478 845.086 Q140.668 845.086 137.589 840.503 Q134.533 835.896 134.533 827.17 Q134.533 818.42 137.589 813.836 Q140.668 809.23 146.478 809.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M102.844 506.455 Q99.2326 506.455 97.4039 510.02 Q95.5984 513.562 95.5984 520.691 Q95.5984 527.798 97.4039 531.362 Q99.2326 534.904 102.844 534.904 Q106.478 534.904 108.283 531.362 Q110.112 527.798 110.112 520.691 Q110.112 513.562 108.283 510.02 Q106.478 506.455 102.844 506.455 M102.844 502.752 Q108.654 502.752 111.709 507.358 Q114.788 511.941 114.788 520.691 Q114.788 529.418 111.709 534.025 Q108.654 538.608 102.844 538.608 Q97.0335 538.608 93.9549 534.025 Q90.8993 529.418 90.8993 520.691 Q90.8993 511.941 93.9549 507.358 Q97.0335 502.752 102.844 502.752 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M123.006 532.057 L127.89 532.057 L127.89 537.937 L123.006 537.937 L123.006 532.057 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M142.103 534.001 L158.422 534.001 L158.422 537.937 L136.478 537.937 L136.478 534.001 Q139.14 531.247 143.723 526.617 Q148.33 521.964 149.51 520.622 Q151.755 518.099 152.635 516.363 Q153.538 514.603 153.538 512.914 Q153.538 510.159 151.593 508.423 Q149.672 506.687 146.57 506.687 Q144.371 506.687 141.918 507.451 Q139.487 508.214 136.709 509.765 L136.709 505.043 Q139.533 503.909 141.987 503.33 Q144.441 502.752 146.478 502.752 Q151.848 502.752 155.042 505.437 Q158.237 508.122 158.237 512.613 Q158.237 514.742 157.427 516.664 Q156.64 518.562 154.533 521.154 Q153.955 521.826 150.853 525.043 Q147.751 528.238 142.103 534.001 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M100.76 199.977 Q97.1493 199.977 95.3206 203.542 Q93.515 207.083 93.515 214.213 Q93.515 221.319 95.3206 224.884 Q97.1493 228.426 100.76 228.426 Q104.395 228.426 106.2 224.884 Q108.029 221.319 108.029 214.213 Q108.029 207.083 106.2 203.542 Q104.395 199.977 100.76 199.977 M100.76 196.273 Q106.571 196.273 109.626 200.88 Q112.705 205.463 112.705 214.213 Q112.705 222.94 109.626 227.546 Q106.571 232.13 100.76 232.13 Q94.9502 232.13 91.8715 227.546 Q88.816 222.94 88.816 214.213 Q88.816 205.463 91.8715 200.88 Q94.9502 196.273 100.76 196.273 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M120.922 225.579 L125.807 225.579 L125.807 231.458 L120.922 231.458 L120.922 225.579 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M148.839 200.972 L137.033 219.421 L148.839 219.421 L148.839 200.972 M147.612 196.898 L153.492 196.898 L153.492 219.421 L158.422 219.421 L158.422 223.31 L153.492 223.31 L153.492 231.458 L148.839 231.458 L148.839 223.31 L133.237 223.31 L133.237 218.796 L147.612 196.898 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip272)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1267.73,673.896 1375.75,674.589 1482.47,676.703 1586.62,680.332 1686.97,685.629 1782.35,692.793 1871.68,702.056 1953.98,713.668 2028.39,727.877 2094.21,744.912 
  2150.88,764.965 2197.99,788.171 2235.32,814.592 2262.8,844.202 2280.56,876.882 2288.83,912.407 2288.02,950.444 2278.65,990.556 2261.3,1032.2 2236.67,1074.76 
  2205.48,1117.5 2168.44,1159.67 2126.3,1200.45 2079.73,1238.99 2029.41,1274.47 1975.89,1306.07 1919.72,1333.01 1861.31,1354.62 1801.05,1370.29 1739.23,1379.54 
  1676.08,1381.99 1611.81,1377.43 1546.56,1365.78 1480.48,1347.1 1413.72,1321.6 1346.44,1289.63 1278.85,1251.66 1211.23,1208.26 1143.89,1160.11 1077.26,1107.96 
  1011.85,1052.59 948.253,994.855 887.166,935.586 829.358,875.626 775.668,815.794 726.983,756.864 684.214,699.561 648.261,644.542 619.989,592.386 600.186,543.593 
  589.536,498.571 588.582,457.638 597.698,421.021 617.069,388.863 646.671,361.224 686.262,338.095 735.379,319.41 793.349,305.054 859.296,294.885 932.166,288.744 
  1010.75,286.473 1093.72,287.928 1179.65,292.986 1267.09,301.559 1354.53,313.596 1440.53,329.081 1523.67,348.036 1602.66,370.506 1676.31,396.558 1743.58,426.258 
  1803.59,459.666 1855.69,496.812 1899.36,537.685 1934.33,582.214 1960.5,630.257 1977.96,681.587 1986.97,735.885 1987.92,792.733 1981.34,851.612 1967.84,911.907 
  1948.1,972.907 1922.85,1033.82 1892.8,1093.79 1858.66,1151.91 1821.11,1207.22 1780.76,1258.79 1738.15,1305.68 1693.77,1347.02 1648.02,1381.98 1601.2,1409.85 
  1553.58,1430.04 1505.35,1442.1 1456.64,1445.72 1407.57,1440.77 1358.21,1427.28 1308.66,1405.47 1259.02,1375.7 1209.4,1338.47 1159.98,1294.43 1110.99,1244.32 
  1062.72,1188.98 1015.54,1129.3 969.895,1066.21 926.311,1000.63 885.378,933.504 847.749,865.711 814.117,798.095 785.202,731.434 761.725,666.429 744.377,603.699 
  733.795,543.773 730.532,487.09 735.03,433.998 747.59,384.759 768.356,339.556 797.294,298.498 834.182,261.632 878.605,228.954 929.955,200.426 987.445,175.983 
  1050.12,155.552 1116.87,139.056 1186.49,126.435 1257.66,117.649 1329.02,112.683 1399.2,111.554 1466.83,114.305 1530.62,121.008 1589.36,131.754 1641.97,146.646 
  1687.51,165.787 1725.23,189.272 1754.56,217.172 1775.15,249.526 1786.84,286.326 1789.67,327.512 1783.88,372.962 1769.86,422.481 1748.16,475.807 1719.45,532.597 
  1684.48,592.435 1644.05,654.829 1599.01,719.214 1550.17,784.96 1498.35,851.374 1444.28,917.713 1388.64,983.19 1332.04,1046.99 1274.96,1108.29 1217.83,1166.25 
  1160.98,1220.08 1104.64,1269 1048.98,1312.31 994.126,1349.38 940.143,1379.7 887.074,1402.84 834.953,1418.54 783.824,1426.65 733.753,1427.19 684.847,1420.3 
  637.265,1406.3 591.232,1385.62 547.042,1358.81 505.069,1326.54 465.764,1289.55 429.649,1248.64 397.318,1204.66 369.414,1158.44 346.62,1110.84 329.638,1062.64 
  319.164,1014.61 315.864,967.419 320.349,921.659 333.146,877.831 354.678,836.339 385.237,797.482 424.966,761.466 473.849,728.406 531.698,698.334 598.146,671.22 
  672.655,646.977 754.516,625.489 842.86,606.62 936.675,590.237 1034.83,576.224 1136.07,564.494 1239.07,555.007 1342.47,547.769 1444.84,542.842 1544.78,540.343 
  1640.91,540.436 1731.91,543.323 1816.55,549.235 1893.7,558.416 1962.4,571.102 2021.82,587.505 2071.35,607.796 2110.53,632.084 2139.13,660.402 2157.12,692.694 
  2164.64,728.803 2162.04,768.467 2149.8,811.313 2128.56,856.862 2099.02,904.532 2062,953.65 2018.34,1003.46 1968.89,1053.15 1914.48,1101.85 1855.9,1148.68 
  1793.9,1192.75 1729.14,1233.19 1662.2,1269.19 1593.58,1300 1523.7,1324.97 1452.92,1343.56 1381.53,1355.36 1309.79,1360.09 1237.92,1357.64 1166.14,1348.05 
  1094.68,1331.52 1023.83,1308.38 953.888,1279.1 885.243,1244.3 818.351,1204.66 753.75,1160.98 692.062,1114.09 633.987,1064.88 580.297,1014.23 531.815,963.033 
  489.401,912.124 453.918,862.299 426.211,814.281 407.071,768.708 397.202,726.121 397.193,686.959 407.49,651.552 428.365,620.124 459.906,592.795 502,569.59 
  554.33,550.452 616.372,535.252 687.413,523.81 766.556,515.91 852.749,511.321 944.806,509.81 1041.43,511.165 1141.26,515.206 1242.86,521.792 1344.82,530.835 
  1445.71,542.296 1544.16,556.188 1638.87,572.57 1728.63,591.532 1812.37,613.19 1889.14,637.666 1958.15,665.071 2018.8,695.49 2070.65,728.961 2113.43,765.464 
  2147.08,804.901 2171.67,847.088 2187.45,891.747 2194.8,938.5 2194.22,986.87 2186.29,1036.28 2171.68,1086.08 2151.07,1135.52 2125.18,1183.81 2094.68,1230.1 
  2060.26,1273.54 2022.52,1313.27 1982,1348.46 1939.19,1378.32 1894.49,1402.17 1848.21,1419.39 1800.61,1429.5 1751.86,1432.15 1702.09,1427.12 1651.37,1414.36 
  1599.75,1393.96 1547.27,1366.15 1493.95,1331.31 1439.87,1289.92 1385.11,1242.61 1329.81,1190.06 1274.19,1133.02 1218.54,1072.31 1163.24,1008.76 1108.74,943.205 
  1055.59,876.482 1004.45,809.393 956.005,742.704 911.033,677.128 870.336,613.32 834.732,551.867 805.02,493.288 781.959,438.02 766.228,386.431 758.401,338.806 
  758.917,295.362 768.055,256.241 785.914,221.525 812.399,191.236 847.217,165.354 889.872,143.817 939.674,126.541 995.756,113.429 1057.09,104.382 1122.52,99.3078 
  1190.78,98.1341 1260.54,100.812 1330.44,107.32 1399.12,117.669 1465.28,131.893 1527.67,150.053 1585.17,172.222 1636.78,198.479 1681.67,228.896 1719.19,263.528 
  1748.88,302.395 1770.46,345.475 1783.85,392.688 1789.15,443.889 1786.63,498.856 1776.68,557.283 1759.85,618.782 1736.76,682.872 1708.08,748.988 1674.54,816.476 
  1636.86,884.608 1595.76,952.585 1551.91,1019.55 1505.92,1084.61 1458.34,1146.84 1409.64,1205.33 1360.21,1259.15 1310.37,1307.46 1260.37,1349.47 1210.38,1384.46 
  1160.55,1411.86 1110.98,1431.22 1061.73,1442.23 1012.89,1444.76 964.556,1438.84 916.833,1424.65 869.889,1402.56 823.945,1373.06 779.281,1336.81 736.265,1294.54 
  695.332,1247.09 656.996,1195.35 621.845,1140.27 590.524,1082.78 563.727,1023.8 542.174,964.215 526.588,904.859 517.672,846.482 516.074,789.747 522.367,735.224 
  537.013,683.383 560.341,634.592 592.524,589.123 633.557,547.159 683.249,508.803 741.218,474.091 806.876,443.009 879.452,415.507 957.996,391.516 1041.4,370.966 
  1128.4,353.795 1217.66,339.969 1307.74,329.484 1397.16,322.375 1484.42,318.715 1568.08,318.616 1646.75,322.22 1719.12,329.689 1784.04,341.192 1840.53,356.894 
  1887.77,376.935 1925.17,401.421 1952.34,430.4 1969.11,463.858 1975.55,501.702 1971.89,543.751 1958.58,589.734 1936.21,639.287 1905.51,691.951 1867.3,747.178 
  1822.45,804.34 1771.88,862.731 1716.5,921.588 1657.16,980.099 1594.7,1037.42 1529.85,1092.7 1463.27,1145.08 1395.55,1193.75 1327.15,1237.92 1258.46,1276.89 
  1189.81,1310.04 1121.44,1336.86 1053.57,1356.96 986.348,1370.07 919.953,1376.08 854.548,1375.04 790.325,1367.11 727.52,1352.63 666.421,1332.04 607.382,1305.93 
  550.832,1274.95 497.272,1239.87 447.28,1201.49 401.496,1160.65 360.618,1118.21 325.377,1075 296.523,1031.81 274.798,989.384 260.91,948.392 255.507,909.409 
  259.148,872.913 272.28,839.275 295.215,808.759 328.115,781.522 370.977,757.618 423.624,737.014 485.71,719.595 556.718,705.18 635.973,693.549 722.65,684.449 
  815.797,677.621 914.348,672.819 1017.15,669.821 1122.97,668.448 1230.54,668.574 1338.56,670.134 1445.73,673.129 1550.75,677.62 1652.4,683.731 1749.47,691.633 
  1840.87,701.536 1925.6,713.674 2002.77,728.285 2071.64,745.593 2131.61,765.793 2182.24,789.028 2223.27,815.374 2254.59,844.827 2276.27,877.289 2288.51,912.564 
  2291.67,950.348 2286.23,990.231 2272.77,1031.7 2251.92,1074.16 2224.4,1116.92 2190.92,1159.23 2152.19,1200.29 2108.91,1239.26 2061.74,1275.32 2011.25,1307.65 
  1957.99,1335.47 1902.38,1358.08 1844.82,1374.86 1785.61,1385.3 1724.98,1388.99 1663.13,1385.69 1600.2,1375.28 1536.32,1357.79 1471.62,1333.38 1406.22,1302.38 
  1340.3,1265.21 1274.08,1222.42 1207.83,1174.65 1141.92,1122.63 1076.79,1067.13 1012.98,1008.97 951.13,948.988 891.95,888.014 836.242,826.867 784.862,766.329 
  738.705,707.137 698.677,649.967 665.666,595.423 640.504,544.032 623.939,496.239 616.598,452.399 618.958,412.781 631.317,377.566 653.778,346.859 686.227,320.688 
  728.337,299.021 779.559,281.773 839.138,268.827 906.127,260.038 979.409,255.259 1057.73,254.347 1139.72,257.175 1223.94,263.647 1308.93,273.698 1393.2,287.3 
  1475.34,304.461 1553.99,325.215 1627.91,349.621 1695.98,377.747 1757.25,409.655 1810.97,445.391 1856.55,484.964 1893.6,528.333 1921.96,575.391 1941.62,625.956 
  1952.77,679.755 1955.75,736.421 1951.02,795.488 1939.18,856.391 1920.86,918.468 1896.78,980.969 1867.67,1043.07 1834.23,1103.88 1797.17,1162.46 1757.11,1217.88 
  1714.65,1269.16 1670.29,1315.4 1624.45,1355.73 1577.5,1389.36 1529.73,1415.62 1481.33,1433.95 1432.49,1443.96 1383.32,1445.41 1333.93,1438.21 1284.41,1422.48 
  1234.85,1398.49 1185.38,1366.64 1136.16,1327.52 1087.4,1281.82 1039.38,1230.32 992.447,1173.89 947.034,1113.46 903.639,1049.95 862.837,984.325 825.264,917.495 
  791.603,850.345 762.57,783.696 738.884,718.302 721.246,654.831 710.308,593.866 706.647,535.894 710.735,481.313 722.909,430.425 743.355,383.452 772.081,340.534 
  808.913,301.747 853.477,267.105 905.211,236.586 963.362,210.134 1027.01,187.679 1095.06,169.148 1166.33,154.479 1239.5,143.628 1313.2,136.575 1386.04,133.333 
  1456.62,133.944 1523.6,138.478 1585.72,147.027 1641.85,159.699 1690.97,176.605 1732.26,197.848 1765.1,223.513 1789.04,253.653 1803.87,288.276 1809.56,327.339 
  1806.3,370.734 1794.44,418.287 1774.5,469.748 1747.12,524.791 1713.04,583.015 1673.09,643.94 1628.1,707.014 1578.93,771.62 1526.42,837.075 1471.34,902.646 
  1414.41,967.556 1356.28,1031 1297.49,1092.16 1238.49,1150.2 1179.66,1204.33 1121.27,1253.78 1063.53,1297.85 1006.57,1335.89 950.481,1367.37 895.334,1391.88 
  841.167,1409.11 788.03,1418.9 735.991,1421.24 685.152,1416.26 635.667,1404.23 587.751,1385.56 541.69,1360.79 497.842,1330.55 456.647,1295.55 418.617,1256.59 
  384.332,1214.49 354.422,1170.09 329.571,1124.22 310.477,1077.68 297.836,1031.22 292.32,985.529 294.551,941.201 305.073,898.746 324.329,858.575 352.637,820.996 
  390.176,786.219 436.963,754.364 492.851,725.463 557.518,699.479 630.474,676.322 711.059,655.858 798.456,637.936 891.706,622.399 989.72,609.107 1091.31,597.946 
  1195.19,588.844 1300.01,581.781 1404.42,576.791 1507,573.965 1606.4,573.449 1701.29,575.433 1790.41,580.144 1872.62,587.828 1946.89,598.736 2012.34,613.103 
  2068.25,631.131 2114.11,652.97 2149.58,678.701 2174.52,708.321 2188.98,741.729 2193.19,778.723 2187.55,818.99 2172.61,862.107 2149.02,907.546 2117.54,954.68 
  2078.96,1002.79 2034.11,1051.1 1983.83,1098.76 1928.91,1144.9 1870.1,1188.64 1808.11,1229.09 1743.53,1265.42 1676.91,1296.85 1608.69,1322.69 1539.26,1342.35 
  1468.94,1355.37 1397.98,1361.42 1326.63,1360.31 1255.11,1352.03 1183.62,1336.7 1112.42,1314.6 1041.79,1286.15 972.07,1251.9 903.68,1212.51 837.111,1168.73 
  772.939,1121.38 711.828,1071.32 654.517,1019.43 601.812,966.611 554.568,913.718 513.662,861.573 479.969,810.935 454.331,762.489 437.522,716.827 430.219,674.445 
  432.967,635.734 446.154,600.981 469.986,570.367 504.473,543.978 549.416,521.807 604.41,503.776 668.835,489.742 741.891,479.52 822.594,472.898 909.808,469.655 
  1002.27,469.583 1098.64,472.491 1197.47,478.228 1297.34,486.685 1396.77,497.802 1494.37,511.569 1588.76,528.018 1678.69,547.22 1763.01,569.27 1840.71,594.274 
  1910.94,622.333 1973.02,653.524 2026.44,687.887 2070.9,725.402 2106.25,765.979 2132.55,809.446 2149.99,855.536 2158.93,903.882 2159.84,954.021 2153.3,1005.39 
  2139.95,1057.33 2120.49,1109.11 2095.63,1159.93 2066.08,1208.94 2032.51,1255.26 1995.55,1298.02 1955.77,1336.35 1913.68,1369.44 1869.69,1396.56 1824.14,1417.04 
  1777.31,1430.37 1729.38,1436.14 1680.5,1434.1 1630.76,1424.13 1580.21,1406.3 1528.91,1380.81 1476.87,1348 1424.17,1308.34 1370.88,1262.44 1317.16,1210.99 
  1263.2,1154.73 1209.27,1094.49 1155.72,1031.12 1103.01,965.473 1051.66,898.401 1002.27,830.732 955.543,763.254 912.205,696.705 873.036,631.76 838.83,569.029 
  810.365,509.046 788.379,452.269 773.539,399.077 766.405,349.771 767.412,304.578 776.836,263.652 794.78,227.082 821.158,194.901 855.687,167.093 897.885,143.605 
  947.079,124.359 1002.42,109.263 1062.9,98.2216 1127.38,91.1493 1194.6,87.9763 1263.27,88.6571 1332.02,93.1741 1399.51,101.539 1464.44,113.79 1525.57,129.991 
  1581.78,150.217 1632.08,174.554 1675.63,203.079 1711.78,235.855 1740.06,272.913 1760.2,314.244 1772.12,359.785 1775.92,409.41 1771.86,462.921 1760.36,520.042 
  1741.95,580.413 1717.26,643.589 1687,709.04 1651.89,776.155 1612.67,844.241 1570.07,912.54 1524.77,980.232 1477.4,1046.45 1428.53,1110.3 1378.64,1170.88 
  1328.12,1227.28 1277.32,1278.64 1226.46,1324.15 1175.75,1363.08 1125.31,1394.8 1075.24,1418.8 1025.61,1434.72 976.479,1442.34 927.927,1441.62 880.053,1432.66 
  832.998,1415.75 786.959,1391.3 742.195,1359.89 699.042,1322.2 657.913,1279.01 619.296,1231.18 583.755,1179.63 551.919,1125.26 524.47,1069 502.116,1011.75 
  485.584,954.346 475.585,897.562 472.788,842.092 477.793,788.537 491.1,737.399 513.089,689.08 543.988,643.882 583.858,602.013 632.577,563.597 689.834,528.688 
  755.12,497.281 827.738,469.327 906.81,444.756 991.291,423.489 1079.99,405.454 1171.6,390.601 1264.72,378.909 1357.88,370.397 1449.6,365.129 1538.41,363.206 
  1622.86,364.766 1701.62,369.978 1773.45,379.021 1837.27,392.081 1892.15,409.324 1937.38,430.889 1972.45,456.864 1997.06,487.277 2011.15,522.08 2014.83,561.138 
  2008.44,604.222 1992.49,651.009 1967.61,701.075 1934.57,753.9 1894.22,808.877 1847.44,865.318 1795.14,922.466 1738.21,979.509 1677.5,1035.6 1613.79,1089.87 
  1547.79,1141.45 1480.14,1189.49 1411.35,1233.2 1341.88,1271.84 1272.09,1304.75 1202.29,1331.4 1132.7,1351.36 1063.54,1364.34 994.991,1370.2 927.239,1368.94 
  860.489,1360.74 794.983,1345.87 731.011,1324.8 668.931,1298.07 609.169,1266.36 552.229,1230.42 498.691,1191.05 449.204,1149.12 404.475,1105.48 365.256,1060.99 
  332.319,1016.46 306.437,972.677 288.353,930.32 278.753,890 278.241,852.227 287.308,817.404 306.31,785.825 335.45,757.674 374.765,733.034 424.111,711.889 
  483.166,694.144 551.434,679.632 628.247,668.138 712.786,659.414 804.093,653.197 901.093,649.234 1002.61,647.29 1107.41,647.172 1214.19,648.735 1321.62,651.892 
  1428.4,656.619 1533.21,662.954 1634.8,670.993 1731.97,680.884 1823.6,692.809 1908.7,706.977 1986.38,723.603 2055.9,742.89 2116.67,765.009 2168.26,790.087 
  2210.4,818.183 2243,849.279 2266.12,883.264 2279.98,919.93 2284.93,958.965 2281.46,999.955 2270.13,1042.38 2251.57,1085.65 2226.49,1129.05 2195.58,1171.85 
  2159.56,1213.25 2119.1,1252.41 2074.84,1288.51 2027.36,1320.73 1977.17,1348.32 1924.69,1370.57 1870.29,1386.87 1814.27,1396.71 1756.83,1399.72 1698.15,1395.64 
  1638.35,1384.38 1577.54,1365.96 1515.82,1340.57 1453.27,1308.53 1390.04,1270.27 1326.29,1226.34 1262.27,1177.39 1198.29,1124.13 1134.74,1067.33 1072.11,1007.82 
  1010.99,946.4 952.048,883.911 896.039,821.156 843.789,758.911 796.166,697.904 754.065,638.807 718.373,582.226 689.94,528.691 669.542,478.653 657.852,432.48 
  655.407,390.458 662.578,352.789 679.55,319.598 706.302,290.939 742.597,266.804 787.984,247.132 841.802,231.826 903.188,220.762 971.106,213.806 1044.37,210.826 
  1121.66,211.704 1201.58,216.344 1282.69,224.682 1363.54,236.687 1442.7,252.362 1518.79,271.738 1590.56,294.869 1656.86,321.824 1716.7,352.669 1769.27,387.456 
  1813.95,426.205 1850.31,468.896 1878.12,515.445 1897.33,565.698 1908.11,619.419 1910.73,676.276 1905.66,735.846 1893.43,797.604 1874.71,860.93 1850.17,925.113 
  1820.54,989.359 1786.54,1052.81 1748.87,1114.54 1708.18,1173.61 1665.07,1229.07 1620.06,1279.96 1573.6,1325.39 1526.06,1364.52 1477.75,1396.6 1428.89,1421.01 
  1379.66,1437.27 1330.2,1445.03 1280.62,1444.13 1231.01,1434.57 1181.49,1416.54 1132.16,1390.36 1083.2,1356.54 1034.81,1315.7 987.282,1268.59 940.947,1216.05 
  896.23,1158.97 853.63,1098.31 813.715,1035 777.12,970.011 744.527,904.239 716.65,838.548 694.211,773.732 677.915,710.506 668.422,649.493 666.319,591.225 
  672.085,536.137 686.074,484.568 708.483,436.769 739.334,392.905 778.465,353.071 825.514,317.299 879.927,285.576 940.957,257.853 1007.68,234.066 1079.02,214.145 
  1153.75,198.027 1230.55,185.669 1308.04,177.056 1384.78,172.201 1459.34,171.152 1530.35,173.984 1596.5,180.8 1656.58,191.715 1709.55,206.853 1754.53,226.33 
  
  "/>
<path clip-path="url(#clip270)" d="
M1988.57 198.898 L2280.81 198.898 L2280.81 95.2176 L1988.57 95.2176  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip270)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1988.57,198.898 2280.81,198.898 2280.81,95.2176 1988.57,95.2176 1988.57,198.898 
  "/>
<polyline clip-path="url(#clip270)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2012.55,147.058 2156.44,147.058 
  "/>
<path clip-path="url(#clip270)" d="M2194.26 166.745 Q2192.46 171.375 2190.74 172.787 Q2189.03 174.199 2186.16 174.199 L2182.76 174.199 L2182.76 170.634 L2185.26 170.634 Q2187.02 170.634 2187.99 169.8 Q2188.96 168.967 2190.14 165.865 L2190.9 163.921 L2180.42 138.412 L2184.93 138.412 L2193.03 158.689 L2201.14 138.412 L2205.65 138.412 L2194.26 166.745 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip270)" d="M2212.94 160.402 L2220.58 160.402 L2220.58 134.037 L2212.27 135.703 L2212.27 131.444 L2220.53 129.778 L2225.21 129.778 L2225.21 160.402 L2232.85 160.402 L2232.85 164.338 L2212.94 164.338 L2212.94 160.402 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<h3 id="Solving-the-second-order-ODE-directly"><a class="docs-heading-anchor" href="#Solving-the-second-order-ODE-directly">Solving the second-order ODE directly</a><a id="Solving-the-second-order-ODE-directly-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-second-order-ODE-directly" title="Permalink"></a></h3><p>Instead of first transforming the problem, we can also solve it directly as a second-order ODE, by defining it as a <code>SecondOrderODEProblem</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>SecondOrderODEProblem</code> type is not defined in ProbNumDiffEq.jl but is provided by SciMLBase.jl. For more information, check out the DifferentialEquations.jl documentation on <a href="https://diffeq.sciml.ai/stable/types/dynamical_types/">Dynamical, Hamiltonian and 2nd Order ODE Problems</a>.</p></div></div><pre><code class="language- hljs">function Hénon_Heiles2(ddu, du, u, p, t)
    ddu[1] = -u[1] - 2 * u[1] * u[2]
    ddu[2] = u[2]^2 - u[2] - u[1]^2
end
prob2 = SecondOrderODEProblem(Hénon_Heiles2, du0, u0, tspan)
sol2 = solve(prob2, EK1());
plot(sol2, vars=(3, 4))</code></pre><h3 id="Benchmark:-Solving-second-order-ODEs-is-*faster*"><a class="docs-heading-anchor" href="#Benchmark:-Solving-second-order-ODEs-is-*faster*">Benchmark: Solving second order ODEs is <em>faster</em></a><a id="Benchmark:-Solving-second-order-ODEs-is-*faster*-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmark:-Solving-second-order-ODEs-is-*faster*" title="Permalink"></a></h3><p>Solving second-order ODEs is not just a matter of convenience - in fact, SciMLBase&#39;s <code>SecondOrderODEProblem</code> is neatly designed in such a way that all the classic solvers from OrdinaryDiffEq.jl can handle it by solving the corresponding first-order ODE. But, transforming the ODE to first order increases the dimensionality of the problem, and comes therefore at increased computational cost; this also motivates <a href="https://diffeq.sciml.ai/stable/solvers/dynamical_solve/">classic specialized solvers for second-order ODEs</a>.</p><p>The probabilistic numerical solvers from ProbNumDiffEq.jl have the same internal state representation for first and second order ODEs; all that changes is the <em>measurement model</em> [1]. As a result, we can use the <code>EK1</code> both for first and second order ODEs, but it automatically specializes on the latter to provide a <strong>2x performance boost</strong>:</p><pre><code class="nohighlight hljs">julia&gt; @btime solve(prob, EK1(order=3), adaptive=false, dt=1e-2);
  766.312 ms (400362 allocations: 173.38 MiB)

julia&gt; @btime solve(prob2, EK1(order=4), adaptive=false, dt=1e-2);
  388.301 ms (510676 allocations: 102.78 MiB)</code></pre><h2 id="Energy-preservation"><a class="docs-heading-anchor" href="#Energy-preservation">Energy preservation</a><a id="Energy-preservation-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-preservation" title="Permalink"></a></h2><p>In addition to the ODE given above, we know that the solution of the Hénon-Heiles model has to <em>preserve energy</em> over time. The total energy can be expressed as the sum of the potential and kinetic energies, given by</p><p class="math-container">\[\begin{aligned}
\operatorname{PotentialEnergy}(x,y) &amp;= \frac{1}{2} \left( x^2 + y^2 + 2 x^2 y - \frac{2y^3}{3} \right), \\
\operatorname{KineticEnergy}(\dot{x}, \dot{y}) &amp;= \frac{1}{2} \left( \dot{x}^2 + \dot{y}^2 \right).
\end{aligned}\]</p><p>In code:</p><pre><code class="language-julia hljs">PotentialEnergy(x, y) = 1 // 2 * (x^2 + y^2 + 2x^2 * y - 2 // 3 * y^3)
KineticEnergy(dx, dy) = 1 // 2 * (dx^2 + dy^2)
E(dx, dy, x, y) = PotentialEnergy(x, y) + KineticEnergy(dx, dy)
E(u) = E(u...); # convenient shorthand</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">E (generic function with 2 methods)</code></pre><p>So, let&#39;s have a look at how the total energy changes over time when we numerically simulate the Hénon-Heiles model over a long period of time: Standard solve</p><pre><code class="language- hljs">longprob = remake(prob2, tspan=(0.0, 1e3))
longsol = solve(longprob, EK1(smooth=false), dense=false)
plot(longsol.t, E.(longsol.u))</code></pre><p>It visibly loses energy over time, from an initial 0.12967 to a final 0.12899. Let&#39;s fix this to get a physically more meaningful solution.</p><h3 id="Energy-preservation-with-the-ManifoldUpdate-callback"><a class="docs-heading-anchor" href="#Energy-preservation-with-the-ManifoldUpdate-callback">Energy preservation with the <code>ManifoldUpdate</code> callback</a><a id="Energy-preservation-with-the-ManifoldUpdate-callback-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-preservation-with-the-ManifoldUpdate-callback" title="Permalink"></a></h3><p>In the language of ODE filters, preserving energy over time amounts to just another measurement model [1]. The most convenient way of updating on this additional zero measurement with ProbNumDiffEq.jl is with the <code>ManifoldUpdate</code> callback.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>ManifoldUpdate</code> callback can be thought of a probabilistic counterpart to the <a href="https://diffeq.sciml.ai/stable/features/callback_library/#Manifold-Conservation-and-Projection"><code>ManifoldProjection</code></a> callback provided by DiffEqCallbacks.jl.</p></div></div><p>To do so, first define a (vector-valued) residual function, here chosen to be the difference between the current energy and the initial energy, and build a <code>ManifoldUpdate</code> callback</p><pre><code class="language-julia hljs">residual(u) = [E(u) - E(du0..., u0...)]
cb = ManifoldUpdate(residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DiscreteCallback{ProbNumDiffEq.var&quot;#condition#47&quot;, ProbNumDiffEq.var&quot;#affect!#48&quot;{Int64, Float64, Float64, typeof(Main.residual)}, typeof(SciMLBase.INITIALIZE_DEFAULT), typeof(SciMLBase.FINALIZE_DEFAULT)}(ProbNumDiffEq.var&quot;#condition#47&quot;(), ProbNumDiffEq.var&quot;#affect!#48&quot;{Int64, Float64, Float64, typeof(Main.residual)}(100, 1.0e-25, 1.0e-15, Main.residual), SciMLBase.INITIALIZE_DEFAULT, SciMLBase.FINALIZE_DEFAULT, Bool[1, 1])</code></pre><p>Then, solve the ODE with this callback</p><pre><code class="language- hljs">longsol_preserving = solve(longprob, EK1(smooth=false), dense=false, callback=cb)
plot(longsol.t, E.(longsol.u))
plot!(longsol_preserving.t, E.(longsol_preserving.u))</code></pre><p>Voilà! With the <code>ManifoldUpdate</code> callback we could preserve the energy over time and obtain a more truthful probabilistic numerical long-term simulation of the Hénon-Heiles model.</p><h4 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h4><p>[1] N. Bosch, F. Tronarp, P. Hennig: <strong>Pick-and-Mix Information Operators for Probabilistic ODE Solvers</strong> (2022)</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Introduction to ODE Filters</a><a class="docs-footer-nextpage" href="../dae/">Differential Algebraic Equations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 26 August 2022 15:00">Friday 26 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
