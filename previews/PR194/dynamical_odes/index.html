<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Second Order ODEs and Energy Preservation · ProbNumDiffEq.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ProbNumDiffEq.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Introduction to ODE Filters</a></li><li class="is-active"><a class="tocitem" href>Second Order ODEs and Energy Preservation</a><ul class="internal"><li><a class="tocitem" href="#Simulating-the-Hénon-Heiles-system"><span>Simulating the Hénon-Heiles system</span></a></li><li><a class="tocitem" href="#Energy-preservation"><span>Energy preservation</span></a></li></ul></li><li><a class="tocitem" href="../dae/">Differential Algebraic Equations</a></li></ul></li><li><a class="tocitem" href="../solvers/">Solvers and Options</a></li><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../filtering/">Filtering and Smoothing</a></li><li><a class="tocitem" href="../implementation/">Implementation via OrdinaryDiffEq.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Second Order ODEs and Energy Preservation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Second Order ODEs and Energy Preservation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/nathanaelbosch/ProbNumDiffEq.jl/blob/main/docs/src/dynamical_odes.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Second-Order-ODEs-and-Energy-Preservation"><a class="docs-heading-anchor" href="#Second-Order-ODEs-and-Energy-Preservation">Second Order ODEs and Energy Preservation</a><a id="Second-Order-ODEs-and-Energy-Preservation-1"></a><a class="docs-heading-anchor-permalink" href="#Second-Order-ODEs-and-Energy-Preservation" title="Permalink"></a></h1><p>In this tutorial we consider an <em>energy-preserving</em>, physical dynamical system, given by a <em>second-order</em> ODE.</p><h4 id="TL;DR:"><a class="docs-heading-anchor" href="#TL;DR:">TL;DR:</a><a id="TL;DR:-1"></a><a class="docs-heading-anchor-permalink" href="#TL;DR:" title="Permalink"></a></h4><ol><li>To <em>efficiently</em> solve second-order ODEs, just define the problem as a <code>SecondOrderODEProblem</code>.</li><li>To preserve constant quantities, use the <code>ManifoldUpdate</code> callback; same syntax as <a href="https://diffeq.sciml.ai/stable/features/callback_library/#Manifold-Conservation-and-Projection">DiffEqCallback.jl&#39;s <code>ManifoldProjection</code></a>.</li></ol><h2 id="Simulating-the-Hénon-Heiles-system"><a class="docs-heading-anchor" href="#Simulating-the-Hénon-Heiles-system">Simulating the Hénon-Heiles system</a><a id="Simulating-the-Hénon-Heiles-system-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-Hénon-Heiles-system" title="Permalink"></a></h2><p>The Hénon-Heiles model describes the motion of a star around a galactic center, restricted to a plane. It is given by a second-order ODE</p><p class="math-container">\[\begin{aligned}
\ddot{x} &amp;= - x - 2 x y \\
\ddot{y} &amp;= y^2 - y - x^2.
\end{aligned}\]</p><p>Our goal is to numerically simulate this system on a time span <span>$t \in [0, T]$</span>, starting with initial values <span>$x(0)=0$</span>, <span>$y(0) = 0.1$</span>, <span>$\dot{x}(0) = 0.5$</span>, <span>$\dot{y}(0) = 0$</span>.</p><h3 id="Transforming-the-problem-into-a-first-order-ODE"><a class="docs-heading-anchor" href="#Transforming-the-problem-into-a-first-order-ODE">Transforming the problem into a first-order ODE</a><a id="Transforming-the-problem-into-a-first-order-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Transforming-the-problem-into-a-first-order-ODE" title="Permalink"></a></h3><p>A very common approach is to first transform the problem into a first-order ODE by introducing a new variable</p><p class="math-container">\[u = [dx,dy,x,y],\]</p><p>to obtain</p><p class="math-container">\[\begin{aligned}
\dot{u}_1(t) &amp;= - u_3 - 2 u_3 u_4 \\
\dot{u}_2(t) &amp;= u_4^2 - u_4 - u_4^2 \\
\dot{u}_3(t) &amp;= u_1 \\
\dot{u}_4(t) &amp;= u_2.
\end{aligned}\]</p><p>This first-order ODE can then be solved using any conventional ODE solver - including our <code>EK1</code>:</p><pre><code class="language-julia hljs">using ProbNumDiffEq, Plots

function Hénon_Heiles(du, u, p, t)
    du[1] = -u[3] - 2 * u[3] * u[4]
    du[2] = u[4]^2 - u[4] - u[3]^2
    du[3] = u[1]
    du[4] = u[2]
end
u0, du0 = [0.0, 0.1], [0.5, 0.0]
tspan = (0.0, 100.0)
prob = ODEProblem(Hénon_Heiles, [du0; u0], tspan)
sol = solve(prob, EK1());
plot(sol, vars=(3, 4)) # where `vars=(3,4)` is used to plot x agains y</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip800">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip800)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip801">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip800)" d="
M194.422 1486.45 L2352.76 1486.45 L2352.76 47.2441 L194.422 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip802">
    <rect x="194" y="47" width="2159" height="1440"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  402.697,1486.45 402.697,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  835.224,1486.45 835.224,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1267.75,1486.45 1267.75,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1700.28,1486.45 1700.28,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2132.81,1486.45 2132.81,47.2441 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1486.45 2352.76,1486.45 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  402.697,1486.45 402.697,1467.55 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  835.224,1486.45 835.224,1467.55 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1267.75,1486.45 1267.75,1467.55 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1700.28,1486.45 1700.28,1467.55 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2132.81,1486.45 2132.81,1467.55 
  "/>
<path clip-path="url(#clip800)" d="M348.982 1532.02 L378.658 1532.02 L378.658 1535.95 L348.982 1535.95 L348.982 1532.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M398.75 1517.37 Q395.139 1517.37 393.31 1520.93 Q391.505 1524.47 391.505 1531.6 Q391.505 1538.71 393.31 1542.27 Q395.139 1545.82 398.75 1545.82 Q402.384 1545.82 404.19 1542.27 Q406.018 1538.71 406.018 1531.6 Q406.018 1524.47 404.19 1520.93 Q402.384 1517.37 398.75 1517.37 M398.75 1513.66 Q404.56 1513.66 407.616 1518.27 Q410.694 1522.85 410.694 1531.6 Q410.694 1540.33 407.616 1544.94 Q404.56 1549.52 398.75 1549.52 Q392.94 1549.52 389.861 1544.94 Q386.806 1540.33 386.806 1531.6 Q386.806 1522.85 389.861 1518.27 Q392.94 1513.66 398.75 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M418.912 1542.97 L423.796 1542.97 L423.796 1548.85 L418.912 1548.85 L418.912 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M446.828 1518.36 L435.023 1536.81 L446.828 1536.81 L446.828 1518.36 M445.602 1514.29 L451.481 1514.29 L451.481 1536.81 L456.412 1536.81 L456.412 1540.7 L451.481 1540.7 L451.481 1548.85 L446.828 1548.85 L446.828 1540.7 L431.227 1540.7 L431.227 1536.19 L445.602 1514.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M782.551 1532.02 L812.226 1532.02 L812.226 1535.95 L782.551 1535.95 L782.551 1532.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M832.319 1517.37 Q828.708 1517.37 826.879 1520.93 Q825.073 1524.47 825.073 1531.6 Q825.073 1538.71 826.879 1542.27 Q828.708 1545.82 832.319 1545.82 Q835.953 1545.82 837.759 1542.27 Q839.587 1538.71 839.587 1531.6 Q839.587 1524.47 837.759 1520.93 Q835.953 1517.37 832.319 1517.37 M832.319 1513.66 Q838.129 1513.66 841.184 1518.27 Q844.263 1522.85 844.263 1531.6 Q844.263 1540.33 841.184 1544.94 Q838.129 1549.52 832.319 1549.52 Q826.509 1549.52 823.43 1544.94 Q820.374 1540.33 820.374 1531.6 Q820.374 1522.85 823.43 1518.27 Q826.509 1513.66 832.319 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M852.481 1542.97 L857.365 1542.97 L857.365 1548.85 L852.481 1548.85 L852.481 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M871.578 1544.91 L887.897 1544.91 L887.897 1548.85 L865.953 1548.85 L865.953 1544.91 Q868.615 1542.16 873.198 1537.53 Q877.805 1532.88 878.985 1531.53 Q881.231 1529.01 882.11 1527.27 Q883.013 1525.51 883.013 1523.82 Q883.013 1521.07 881.069 1519.33 Q879.147 1517.6 876.045 1517.6 Q873.846 1517.6 871.393 1518.36 Q868.962 1519.13 866.184 1520.68 L866.184 1515.95 Q869.008 1514.82 871.462 1514.24 Q873.916 1513.66 875.953 1513.66 Q881.323 1513.66 884.518 1516.35 Q887.712 1519.03 887.712 1523.52 Q887.712 1525.65 886.902 1527.57 Q886.115 1529.47 884.008 1532.07 Q883.43 1532.74 880.328 1535.95 Q877.226 1539.15 871.578 1544.91 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1245.14 1517.37 Q1241.52 1517.37 1239.7 1520.93 Q1237.89 1524.47 1237.89 1531.6 Q1237.89 1538.71 1239.7 1542.27 Q1241.52 1545.82 1245.14 1545.82 Q1248.77 1545.82 1250.58 1542.27 Q1252.4 1538.71 1252.4 1531.6 Q1252.4 1524.47 1250.58 1520.93 Q1248.77 1517.37 1245.14 1517.37 M1245.14 1513.66 Q1250.95 1513.66 1254 1518.27 Q1257.08 1522.85 1257.08 1531.6 Q1257.08 1540.33 1254 1544.94 Q1250.95 1549.52 1245.14 1549.52 Q1239.33 1549.52 1236.25 1544.94 Q1233.19 1540.33 1233.19 1531.6 Q1233.19 1522.85 1236.25 1518.27 Q1239.33 1513.66 1245.14 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1265.3 1542.97 L1270.18 1542.97 L1270.18 1548.85 L1265.3 1548.85 L1265.3 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1290.37 1517.37 Q1286.76 1517.37 1284.93 1520.93 Q1283.12 1524.47 1283.12 1531.6 Q1283.12 1538.71 1284.93 1542.27 Q1286.76 1545.82 1290.37 1545.82 Q1294 1545.82 1295.81 1542.27 Q1297.64 1538.71 1297.64 1531.6 Q1297.64 1524.47 1295.81 1520.93 Q1294 1517.37 1290.37 1517.37 M1290.37 1513.66 Q1296.18 1513.66 1299.23 1518.27 Q1302.31 1522.85 1302.31 1531.6 Q1302.31 1540.33 1299.23 1544.94 Q1296.18 1549.52 1290.37 1549.52 Q1284.56 1549.52 1281.48 1544.94 Q1278.42 1540.33 1278.42 1531.6 Q1278.42 1522.85 1281.48 1518.27 Q1284.56 1513.66 1290.37 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1678.46 1517.37 Q1674.85 1517.37 1673.02 1520.93 Q1671.22 1524.47 1671.22 1531.6 Q1671.22 1538.71 1673.02 1542.27 Q1674.85 1545.82 1678.46 1545.82 Q1682.1 1545.82 1683.9 1542.27 Q1685.73 1538.71 1685.73 1531.6 Q1685.73 1524.47 1683.9 1520.93 Q1682.1 1517.37 1678.46 1517.37 M1678.46 1513.66 Q1684.27 1513.66 1687.33 1518.27 Q1690.41 1522.85 1690.41 1531.6 Q1690.41 1540.33 1687.33 1544.94 Q1684.27 1549.52 1678.46 1549.52 Q1672.65 1549.52 1669.57 1544.94 Q1666.52 1540.33 1666.52 1531.6 Q1666.52 1522.85 1669.57 1518.27 Q1672.65 1513.66 1678.46 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1698.62 1542.97 L1703.51 1542.97 L1703.51 1548.85 L1698.62 1548.85 L1698.62 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1717.72 1544.91 L1734.04 1544.91 L1734.04 1548.85 L1712.1 1548.85 L1712.1 1544.91 Q1714.76 1542.16 1719.34 1537.53 Q1723.95 1532.88 1725.13 1531.53 Q1727.37 1529.01 1728.25 1527.27 Q1729.16 1525.51 1729.16 1523.82 Q1729.16 1521.07 1727.21 1519.33 Q1725.29 1517.6 1722.19 1517.6 Q1719.99 1517.6 1717.54 1518.36 Q1715.1 1519.13 1712.33 1520.68 L1712.33 1515.95 Q1715.15 1514.82 1717.6 1514.24 Q1720.06 1513.66 1722.1 1513.66 Q1727.47 1513.66 1730.66 1516.35 Q1733.85 1519.03 1733.85 1523.52 Q1733.85 1525.65 1733.04 1527.57 Q1732.26 1529.47 1730.15 1532.07 Q1729.57 1532.74 1726.47 1535.95 Q1723.37 1539.15 1717.72 1544.91 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2109.95 1517.37 Q2106.34 1517.37 2104.51 1520.93 Q2102.7 1524.47 2102.7 1531.6 Q2102.7 1538.71 2104.51 1542.27 Q2106.34 1545.82 2109.95 1545.82 Q2113.58 1545.82 2115.39 1542.27 Q2117.22 1538.71 2117.22 1531.6 Q2117.22 1524.47 2115.39 1520.93 Q2113.58 1517.37 2109.95 1517.37 M2109.95 1513.66 Q2115.76 1513.66 2118.81 1518.27 Q2121.89 1522.85 2121.89 1531.6 Q2121.89 1540.33 2118.81 1544.94 Q2115.76 1549.52 2109.95 1549.52 Q2104.14 1549.52 2101.06 1544.94 Q2098 1540.33 2098 1531.6 Q2098 1522.85 2101.06 1518.27 Q2104.14 1513.66 2109.95 1513.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2130.11 1542.97 L2134.99 1542.97 L2134.99 1548.85 L2130.11 1548.85 L2130.11 1542.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2158.03 1518.36 L2146.22 1536.81 L2158.03 1536.81 L2158.03 1518.36 M2156.8 1514.29 L2162.68 1514.29 L2162.68 1536.81 L2167.61 1536.81 L2167.61 1540.7 L2162.68 1540.7 L2162.68 1548.85 L2158.03 1548.85 L2158.03 1540.7 L2142.42 1540.7 L2142.42 1536.19 L2156.8 1514.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,1440.1 2352.76,1440.1 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,1133.58 2352.76,1133.58 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,827.063 2352.76,827.063 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,520.546 2352.76,520.546 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  194.422,214.029 2352.76,214.029 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1486.45 194.422,47.2441 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1440.1 213.32,1440.1 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,1133.58 213.32,1133.58 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,827.063 213.32,827.063 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,520.546 213.32,520.546 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  194.422,214.029 213.32,214.029 
  "/>
<path clip-path="url(#clip800)" d="M50.9921 1440.55 L80.6679 1440.55 L80.6679 1444.48 L50.9921 1444.48 L50.9921 1440.55 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M100.76 1425.9 Q97.1493 1425.9 95.3206 1429.46 Q93.515 1433 93.515 1440.13 Q93.515 1447.24 95.3206 1450.8 Q97.1493 1454.34 100.76 1454.34 Q104.395 1454.34 106.2 1450.8 Q108.029 1447.24 108.029 1440.13 Q108.029 1433 106.2 1429.46 Q104.395 1425.9 100.76 1425.9 M100.76 1422.19 Q106.571 1422.19 109.626 1426.8 Q112.705 1431.38 112.705 1440.13 Q112.705 1448.86 109.626 1453.46 Q106.571 1458.05 100.76 1458.05 Q94.9502 1458.05 91.8715 1453.46 Q88.816 1448.86 88.816 1440.13 Q88.816 1431.38 91.8715 1426.8 Q94.9502 1422.19 100.76 1422.19 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M120.922 1451.5 L125.807 1451.5 L125.807 1457.38 L120.922 1457.38 L120.922 1451.5 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M148.839 1426.89 L137.033 1445.34 L148.839 1445.34 L148.839 1426.89 M147.612 1422.82 L153.492 1422.82 L153.492 1445.34 L158.422 1445.34 L158.422 1449.23 L153.492 1449.23 L153.492 1457.38 L148.839 1457.38 L148.839 1449.23 L133.237 1449.23 L133.237 1444.72 L147.612 1422.82 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M53.0754 1134.03 L82.7512 1134.03 L82.7512 1137.97 L53.0754 1137.97 L53.0754 1134.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M102.844 1119.38 Q99.2326 1119.38 97.4039 1122.94 Q95.5984 1126.49 95.5984 1133.61 Q95.5984 1140.72 97.4039 1144.29 Q99.2326 1147.83 102.844 1147.83 Q106.478 1147.83 108.283 1144.29 Q110.112 1140.72 110.112 1133.61 Q110.112 1126.49 108.283 1122.94 Q106.478 1119.38 102.844 1119.38 M102.844 1115.67 Q108.654 1115.67 111.709 1120.28 Q114.788 1124.86 114.788 1133.61 Q114.788 1142.34 111.709 1146.95 Q108.654 1151.53 102.844 1151.53 Q97.0335 1151.53 93.9549 1146.95 Q90.8993 1142.34 90.8993 1133.61 Q90.8993 1124.86 93.9549 1120.28 Q97.0335 1115.67 102.844 1115.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M123.006 1144.98 L127.89 1144.98 L127.89 1150.86 L123.006 1150.86 L123.006 1144.98 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M142.103 1146.92 L158.422 1146.92 L158.422 1150.86 L136.478 1150.86 L136.478 1146.92 Q139.14 1144.17 143.723 1139.54 Q148.33 1134.89 149.51 1133.55 Q151.755 1131.02 152.635 1129.29 Q153.538 1127.53 153.538 1125.84 Q153.538 1123.08 151.593 1121.35 Q149.672 1119.61 146.57 1119.61 Q144.371 1119.61 141.918 1120.37 Q139.487 1121.14 136.709 1122.69 L136.709 1117.97 Q139.533 1116.83 141.987 1116.25 Q144.441 1115.67 146.478 1115.67 Q151.848 1115.67 155.042 1118.36 Q158.237 1121.05 158.237 1125.54 Q158.237 1127.67 157.427 1129.59 Q156.64 1131.48 154.533 1134.08 Q153.955 1134.75 150.853 1137.97 Q147.751 1141.16 142.103 1146.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M101.246 812.861 Q97.6354 812.861 95.8067 816.426 Q94.0012 819.968 94.0012 827.097 Q94.0012 834.204 95.8067 837.769 Q97.6354 841.31 101.246 841.31 Q104.881 841.31 106.686 837.769 Q108.515 834.204 108.515 827.097 Q108.515 819.968 106.686 816.426 Q104.881 812.861 101.246 812.861 M101.246 809.158 Q107.057 809.158 110.112 813.764 Q113.191 818.348 113.191 827.097 Q113.191 835.824 110.112 840.431 Q107.057 845.014 101.246 845.014 Q95.4363 845.014 92.3576 840.431 Q89.3021 835.824 89.3021 827.097 Q89.3021 818.348 92.3576 813.764 Q95.4363 809.158 101.246 809.158 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M121.408 838.463 L126.293 838.463 L126.293 844.343 L121.408 844.343 L121.408 838.463 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M146.478 812.861 Q142.867 812.861 141.038 816.426 Q139.232 819.968 139.232 827.097 Q139.232 834.204 141.038 837.769 Q142.867 841.31 146.478 841.31 Q150.112 841.31 151.918 837.769 Q153.746 834.204 153.746 827.097 Q153.746 819.968 151.918 816.426 Q150.112 812.861 146.478 812.861 M146.478 809.158 Q152.288 809.158 155.343 813.764 Q158.422 818.348 158.422 827.097 Q158.422 835.824 155.343 840.431 Q152.288 845.014 146.478 845.014 Q140.668 845.014 137.589 840.431 Q134.533 835.824 134.533 827.097 Q134.533 818.348 137.589 813.764 Q140.668 809.158 146.478 809.158 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M102.844 506.344 Q99.2326 506.344 97.4039 509.909 Q95.5984 513.451 95.5984 520.58 Q95.5984 527.687 97.4039 531.252 Q99.2326 534.793 102.844 534.793 Q106.478 534.793 108.283 531.252 Q110.112 527.687 110.112 520.58 Q110.112 513.451 108.283 509.909 Q106.478 506.344 102.844 506.344 M102.844 502.641 Q108.654 502.641 111.709 507.247 Q114.788 511.83 114.788 520.58 Q114.788 529.307 111.709 533.914 Q108.654 538.497 102.844 538.497 Q97.0335 538.497 93.9549 533.914 Q90.8993 529.307 90.8993 520.58 Q90.8993 511.83 93.9549 507.247 Q97.0335 502.641 102.844 502.641 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M123.006 531.946 L127.89 531.946 L127.89 537.826 L123.006 537.826 L123.006 531.946 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M142.103 533.89 L158.422 533.89 L158.422 537.826 L136.478 537.826 L136.478 533.89 Q139.14 531.136 143.723 526.506 Q148.33 521.854 149.51 520.511 Q151.755 517.988 152.635 516.252 Q153.538 514.492 153.538 512.803 Q153.538 510.048 151.593 508.312 Q149.672 506.576 146.57 506.576 Q144.371 506.576 141.918 507.34 Q139.487 508.104 136.709 509.655 L136.709 504.932 Q139.533 503.798 141.987 503.219 Q144.441 502.641 146.478 502.641 Q151.848 502.641 155.042 505.326 Q158.237 508.011 158.237 512.502 Q158.237 514.631 157.427 516.553 Q156.64 518.451 154.533 521.043 Q153.955 521.715 150.853 524.932 Q147.751 528.127 142.103 533.89 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M100.76 199.827 Q97.1493 199.827 95.3206 203.392 Q93.515 206.934 93.515 214.063 Q93.515 221.17 95.3206 224.735 Q97.1493 228.276 100.76 228.276 Q104.395 228.276 106.2 224.735 Q108.029 221.17 108.029 214.063 Q108.029 206.934 106.2 203.392 Q104.395 199.827 100.76 199.827 M100.76 196.124 Q106.571 196.124 109.626 200.73 Q112.705 205.313 112.705 214.063 Q112.705 222.79 109.626 227.397 Q106.571 231.98 100.76 231.98 Q94.9502 231.98 91.8715 227.397 Q88.816 222.79 88.816 214.063 Q88.816 205.313 91.8715 200.73 Q94.9502 196.124 100.76 196.124 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M120.922 225.429 L125.807 225.429 L125.807 231.309 L120.922 231.309 L120.922 225.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M148.839 200.823 L137.033 219.272 L148.839 219.272 L148.839 200.823 M147.612 196.749 L153.492 196.749 L153.492 219.272 L158.422 219.272 L158.422 223.16 L153.492 223.16 L153.492 231.309 L148.839 231.309 L148.839 223.16 L133.237 223.16 L133.237 218.647 L147.612 196.749 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip802)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1267.75,673.804 1375.77,674.498 1482.5,676.612 1586.66,680.242 1687.01,685.539 1782.4,692.704 1871.73,701.968 1954.03,713.581 2028.45,727.792 2094.27,744.83 
  2150.94,764.886 2198.05,788.094 2235.38,814.518 2262.87,844.132 2280.63,876.817 2288.9,912.346 2288.09,950.388 2278.71,990.504 2261.37,1032.16 2236.74,1074.71 
  2205.54,1117.47 2168.5,1159.64 2126.36,1200.42 2079.79,1238.97 2029.46,1274.46 1975.95,1306.05 1919.77,1333 1861.36,1354.62 1801.1,1370.29 1739.27,1379.53 
  1676.12,1381.99 1611.85,1377.43 1546.59,1365.78 1480.51,1347.09 1413.75,1321.59 1346.47,1289.62 1278.88,1251.64 1211.25,1208.24 1143.91,1160.08 1077.28,1107.92 
  1011.86,1052.55 948.264,994.803 887.175,935.527 829.364,875.56 775.672,815.72 726.986,756.783 684.215,699.472 648.261,644.446 619.987,592.284 600.184,543.485 
  589.533,498.457 588.579,457.518 597.696,420.897 617.067,388.734 646.67,361.092 686.262,337.961 735.381,319.273 793.353,304.915 859.303,294.745 932.175,288.603 
  1010.76,286.332 1093.73,287.787 1179.67,292.846 1267.11,301.42 1354.56,313.458 1440.56,328.946 1523.71,347.903 1602.7,370.376 1676.35,396.43 1743.62,426.135 
  1803.64,459.547 1855.73,496.697 1899.41,537.575 1934.38,582.11 1960.55,630.158 1978.01,681.495 1987.02,735.799 1987.97,792.654 1981.38,851.541 1967.88,911.843 
  1948.15,972.851 1922.89,1033.77 1892.84,1093.75 1858.7,1151.87 1821.15,1207.19 1780.79,1258.77 1738.19,1305.67 1693.81,1347 1648.05,1381.97 1601.23,1409.85 
  1553.61,1430.04 1505.37,1442.1 1456.66,1445.72 1407.59,1440.77 1358.23,1427.28 1308.68,1405.47 1259.03,1375.69 1209.41,1338.46 1159.99,1294.41 1111,1244.3 
  1062.72,1188.96 1015.54,1129.27 969.897,1066.17 926.312,1000.58 885.377,933.448 847.747,865.646 814.115,798.023 785.2,731.354 761.722,666.342 744.374,603.604 
  733.792,543.672 730.529,486.982 735.028,433.884 747.588,384.64 768.356,339.432 797.296,298.369 834.187,261.499 878.611,228.818 929.964,200.287 987.456,175.842 
  1050.13,155.408 1116.89,138.91 1186.51,126.289 1257.68,117.502 1329.05,112.537 1399.23,111.407 1466.86,114.159 1530.66,120.864 1589.4,131.612 1642.01,146.506 
  1687.55,165.65 1725.27,189.138 1754.61,217.042 1775.2,249.4 1786.89,286.206 1789.72,327.398 1783.93,372.853 1769.91,422.38 1748.21,475.712 1719.5,532.509 
  1684.53,592.354 1644.1,654.756 1599.05,719.148 1550.22,784.902 1498.39,851.324 1444.32,917.67 1388.68,983.155 1332.08,1046.96 1275,1108.26 1217.87,1166.23 
  1161.01,1220.06 1104.67,1268.99 1049.01,1312.3 994.154,1349.38 940.169,1379.7 887.098,1402.84 834.975,1418.54 783.845,1426.65 733.772,1427.18 684.864,1420.29 
  637.281,1406.29 591.246,1385.6 547.054,1358.79 505.081,1326.51 465.774,1289.52 429.659,1248.6 397.327,1204.61 369.423,1158.39 346.63,1110.78 329.648,1062.58 
  319.176,1014.54 315.877,967.339 320.365,921.573 333.164,877.74 354.699,836.242 385.26,797.381 424.993,761.36 473.88,728.296 531.732,698.22 598.185,671.102 
  672.697,646.857 754.562,625.366 842.91,606.496 936.729,590.111 1034.88,576.096 1136.13,564.365 1239.14,554.877 1342.53,547.639 1444.91,542.713 1544.85,540.214 
  1640.98,540.308 1731.98,543.197 1816.61,549.112 1893.77,558.295 1962.46,570.984 2021.88,587.392 2071.4,607.687 2110.57,631.98 2139.17,660.304 2157.15,692.602 
  2164.67,728.718 2162.07,768.388 2149.83,811.241 2128.57,856.796 2099.03,904.473 2062.01,953.598 2018.34,1003.42 1968.88,1053.11 1914.47,1101.82 1855.89,1148.65 
  1793.89,1192.72 1729.12,1233.17 1662.18,1269.17 1593.55,1299.99 1523.67,1324.96 1452.89,1343.55 1381.5,1355.34 1309.75,1360.07 1237.88,1357.63 1166.09,1348.04 
  1094.64,1331.5 1023.78,1308.35 953.841,1279.07 885.195,1244.26 818.302,1204.62 753.701,1160.93 692.013,1114.04 633.94,1064.83 580.251,1014.18 531.773,962.971 
  489.362,912.057 453.883,862.228 426.18,814.207 407.044,768.631 397.181,726.041 397.178,686.877 407.48,651.468 428.362,620.039 459.91,592.709 502.011,569.504 
  554.347,550.366 616.396,535.166 687.442,523.724 766.592,515.825 852.792,511.235 944.855,509.725 1041.49,511.081 1141.32,515.122 1242.93,521.709 1344.89,530.753 
  1445.78,542.216 1544.23,556.109 1638.94,572.493 1728.7,591.456 1812.44,613.117 1889.21,637.594 1958.23,665.002 2018.87,695.423 2070.72,728.898 2113.5,765.404 
  2147.14,804.844 2171.73,847.035 2187.51,891.698 2194.86,938.455 2194.27,986.829 2186.34,1036.25 2171.73,1086.05 2151.12,1135.49 2125.22,1183.78 2094.72,1230.08 
  2060.3,1273.52 2022.55,1313.25 1982.03,1348.44 1939.22,1378.31 1894.51,1402.15 1848.23,1419.37 1800.62,1429.48 1751.87,1432.13 1702.09,1427.1 1651.37,1414.34 
  1599.75,1393.93 1547.26,1366.12 1493.94,1331.27 1439.85,1289.88 1385.08,1242.56 1329.78,1190 1274.16,1132.96 1218.51,1072.24 1163.2,1008.68 1108.7,943.127 
  1055.55,876.398 1004.4,809.304 955.96,742.609 910.987,677.028 870.291,613.216 834.688,551.76 804.979,493.176 781.921,437.906 766.194,386.314 758.372,338.688 
  758.895,295.242 768.038,256.121 785.904,221.405 812.397,191.117 847.222,165.235 889.885,143.7 939.694,126.426 995.784,113.317 1057.13,104.273 1122.56,99.202 
  1190.82,98.0321 1260.59,100.714 1330.5,107.227 1399.19,117.581 1465.35,131.811 1527.74,149.977 1585.24,172.153 1636.85,198.416 1681.75,228.841 1719.27,263.481 
  1748.96,302.356 1770.54,345.445 1783.93,392.667 1789.23,443.877 1786.7,498.852 1776.76,557.289 1759.93,618.796 1736.83,682.895 1708.15,749.018 1674.61,816.513 
  1636.94,884.651 1595.84,952.633 1551.98,1019.6 1505.99,1084.67 1458.41,1146.9 1409.71,1205.38 1360.28,1259.2 1310.44,1307.51 1260.44,1349.51 1210.46,1384.5 
  1160.63,1411.89 1111.05,1431.23 1061.8,1442.24 1012.97,1444.75 964.626,1438.81 916.902,1424.61 869.957,1402.5 824.011,1372.99 779.35,1336.72 736.333,1294.43 
  695.399,1246.97 657.064,1195.22 621.914,1140.13 590.595,1082.62 563.803,1023.63 542.253,964.04 526.672,904.676 517.76,846.29 516.168,789.549 522.466,735.02 
  537.118,683.174 560.452,634.379 592.641,588.907 633.682,546.94 683.381,508.582 741.354,473.869 807.016,442.786 879.595,415.283 958.139,391.293 1041.54,370.743 
  1128.55,353.574 1217.8,339.75 1307.88,329.268 1397.28,322.162 1484.54,318.507 1568.19,318.413 1646.84,322.023 1719.2,329.498 1784.11,341.009 1840.58,356.719 
  1887.81,376.77 1925.19,401.265 1952.34,430.255 1969.09,463.724 1975.51,501.578 1971.83,543.638 1958.51,589.632 1936.13,639.196 1905.41,691.871 1867.19,747.109 
  1822.34,804.28 1771.76,862.681 1716.36,921.547 1657.02,980.066 1594.56,1037.39 1529.7,1092.68 1463.13,1145.07 1395.4,1193.74 1327,1237.91 1258.32,1276.89 
  1189.67,1310.04 1121.31,1336.86 1053.43,1356.95 986.221,1370.07 919.83,1376.08 854.43,1375.03 790.213,1367.11 727.413,1352.62 666.32,1332.03 607.289,1305.91 
  550.745,1274.93 497.194,1239.84 447.209,1201.46 401.434,1160.62 360.565,1118.18 325.333,1074.96 296.49,1031.77 274.775,989.34 260.899,948.346 255.507,909.361 
  259.159,872.862 272.302,839.222 295.248,808.703 328.159,781.464 371.03,757.559 423.687,736.952 485.782,719.529 556.798,705.112 636.06,693.476 722.744,684.373 
  815.896,677.542 914.452,672.736 1017.25,669.734 1123.08,668.357 1230.65,668.479 1338.67,670.036 1445.84,673.027 1550.86,677.515 1652.5,683.623 1749.57,691.523 
  1840.97,701.425 1925.69,713.562 2002.86,728.172 2071.72,745.481 2131.68,765.682 2182.3,788.918 2223.32,815.267 2254.63,844.723 2276.29,877.189 2288.52,912.468 
  2291.67,950.256 2286.22,990.144 2272.74,1031.62 2251.89,1074.09 2224.35,1116.85 2190.85,1159.16 2152.11,1200.22 2108.82,1239.2 2061.63,1275.26 2011.14,1307.59 
  1957.85,1335.42 1902.24,1358.03 1844.67,1374.81 1785.44,1385.24 1724.8,1388.94 1662.93,1385.63 1599.99,1375.22 1536.1,1357.72 1471.39,1333.32 1405.98,1302.31 
  1340.06,1265.13 1273.83,1222.34 1207.57,1174.57 1141.66,1122.54 1076.52,1067.04 1012.71,1008.88 950.861,948.898 891.685,887.923 835.982,826.777 784.611,766.241 
  738.466,707.052 698.454,649.886 665.46,595.347 640.319,543.963 623.777,496.176 616.462,452.344 618.849,412.734 631.237,377.53 653.727,346.832 686.205,320.671 
  728.346,299.014 779.594,281.778 839.203,268.842 906.217,260.064 979.525,255.295 1057.87,254.393 1139.87,257.231 1224.11,263.713 1309.11,273.774 1393.4,287.386 
  1475.55,304.555 1554.21,325.319 1628.12,349.735 1696.2,377.87 1757.47,409.787 1811.19,445.533 1856.76,485.114 1893.81,528.491 1922.17,575.558 1941.82,626.13 
  1952.97,679.935 1955.94,736.606 1951.21,795.677 1939.36,856.582 1921.04,918.658 1896.97,981.158 1867.85,1043.25 1834.41,1104.05 1797.35,1162.63 1757.3,1218.03 
  1714.83,1269.3 1670.47,1315.53 1624.64,1355.83 1577.69,1389.44 1529.92,1415.67 1481.52,1433.98 1432.68,1443.96 1383.52,1445.38 1334.13,1438.16 1284.61,1422.4 
  1235.05,1398.37 1185.58,1366.5 1136.35,1327.36 1087.59,1281.63 1039.57,1230.11 992.636,1173.66 947.221,1113.21 903.824,1049.69 863.02,984.045 825.444,917.203 
  791.782,850.043 762.746,783.388 739.058,717.988 721.417,654.513 710.476,593.545 706.812,535.573 710.896,480.991 723.067,430.105 743.508,383.133 772.23,340.219 
  809.053,301.434 853.613,266.798 905.335,236.283 963.481,209.837 1027.11,187.387 1095.16,168.864 1166.41,154.202 1239.57,143.358 1313.26,136.314 1386.08,133.081 
  1456.64,133.702 1523.61,138.245 1585.72,146.805 1641.82,159.488 1690.93,176.406 1732.21,197.661 1765.04,223.338 1788.97,253.491 1803.79,288.127 1809.47,327.202 
  1806.2,370.611 1794.34,418.176 1774.39,469.65 1747.01,524.706 1712.94,582.942 1672.99,643.879 1628,706.966 1578.84,771.582 1526.34,837.048 1471.27,902.629 
  1414.35,967.549 1356.23,1031 1297.45,1092.16 1238.47,1150.22 1179.65,1204.35 1121.27,1253.81 1063.54,1297.87 1006.59,1335.92 950.521,1367.4 895.385,1391.91 
  841.232,1409.13 788.107,1418.92 736.079,1421.25 685.252,1416.26 635.779,1404.23 587.875,1385.55 541.824,1360.77 497.988,1330.51 456.805,1295.5 418.783,1256.53 
  384.507,1214.41 354.611,1170 329.771,1124.11 310.688,1077.55 298.056,1031.08 292.551,985.37 294.792,941.026 305.323,898.555 324.588,858.366 352.906,820.77 
  390.452,785.978 437.246,754.106 493.141,725.189 557.813,699.19 630.774,676.017 711.361,655.54 798.76,637.604 892.008,622.056 990.021,608.753 1091.6,597.583 
  1195.47,588.474 1300.29,581.405 1404.67,576.412 1507.24,573.585 1606.61,573.07 1701.48,575.059 1790.57,579.776 1872.75,587.47 1946.98,598.389 2012.39,612.77 
  2068.26,630.815 2114.08,652.672 2149.5,678.422 2174.39,708.062 2188.8,741.491 2192.96,778.508 2187.28,818.796 2172.3,861.934 2148.67,907.393 2117.14,954.546 
  2078.52,1002.68 2033.64,1051 1983.33,1098.68 1928.38,1144.83 1869.55,1188.57 1807.54,1229.03 1742.94,1265.36 1676.3,1296.8 1608.07,1322.64 1538.62,1342.3 
  1468.29,1355.32 1397.33,1361.36 1325.97,1360.25 1254.44,1351.96 1182.95,1336.63 1111.74,1314.52 1041.12,1286.07 971.405,1251.83 903.023,1212.44 836.466,1168.66 
  772.31,1121.31 711.219,1071.25 653.933,1019.37 601.258,966.563 554.047,913.682 513.179,861.552 479.529,810.932 453.938,762.504 437.179,716.862 429.929,674.501 
  432.732,635.813 445.975,601.082 469.865,570.492 504.406,544.123 549.408,521.975 604.451,503.963 668.932,489.948 742.031,479.743 822.777,473.136 910.03,469.907 
  1002.53,469.845 1098.92,472.762 1197.78,478.505 1297.66,486.967 1397.11,498.088 1494.72,511.856 1589.12,528.305 1679.06,547.505 1763.38,569.552 1841.08,594.552 
  1911.31,622.605 1973.38,653.791 2026.8,688.146 2071.25,725.653 2106.6,766.221 2132.89,809.678 2150.32,855.756 2159.26,904.09 2160.16,954.215 2153.62,1005.57 
  2140.27,1057.49 2120.81,1109.26 2095.94,1160.06 2066.39,1209.05 2032.81,1255.35 1995.85,1298.08 1956.07,1336.39 1913.98,1369.46 1869.98,1396.55 1824.43,1417.02 
  1777.59,1430.33 1729.65,1436.07 1680.77,1434.01 1631.02,1424.03 1580.46,1406.18 1529.14,1380.67 1477.09,1347.84 1424.37,1308.18 1371.08,1262.27 1317.34,1210.8 
  1263.36,1154.54 1209.41,1094.3 1155.85,1030.92 1103.12,965.272 1051.75,898.2 1002.35,830.533 955.598,763.058 912.241,696.512 873.054,631.572 838.83,568.846 
  810.348,508.87 788.347,452.1 773.491,398.917 766.344,349.62 767.338,304.437 776.752,263.522 794.688,226.964 821.059,194.795 855.583,167 897.778,143.525 
  946.972,124.294 1002.31,109.213 1062.8,98.1879 1127.28,91.1321 1194.51,87.9763 1263.19,88.6747 1331.95,93.2098 1399.46,101.593 1464.4,113.863 1525.55,130.083 
  1581.78,150.328 1632.09,174.684 1675.66,203.229 1711.84,236.024 1740.14,273.101 1760.31,314.451 1772.26,360.011 1776.08,409.654 1772.05,463.183 1760.57,520.319 
  1742.19,580.705 1717.53,643.894 1687.29,709.357 1652.21,776.48 1613.01,844.573 1570.43,912.874 1525.15,980.565 1477.8,1046.78 1428.95,1110.62 1379.07,1171.18 
  1328.57,1227.56 1277.78,1278.89 1226.93,1324.37 1176.23,1363.27 1125.79,1394.95 1075.73,1418.91 1026.1,1434.78 976.974,1442.35 928.424,1441.58 880.551,1432.57 
  833.496,1415.6 787.456,1391.1 742.693,1359.64 699.541,1321.89 658.412,1278.66 619.797,1230.79 584.259,1179.19 552.427,1124.78 524.981,1068.49 502.634,1011.21 
  486.11,953.774 476.119,896.964 473.331,841.473 478.346,787.899 491.664,736.745 513.663,688.413 544.571,643.203 584.449,601.325 633.174,562.902 690.434,527.988 
  755.72,496.576 828.333,468.621 907.396,444.051 991.863,422.786 1080.54,404.755 1172.12,389.908 1265.21,378.225 1358.33,369.726 1450,364.472 1538.74,362.566 
  1623.14,364.148 1701.83,369.382 1773.58,378.452 1837.32,391.541 1892.12,408.815 1937.26,430.413 1972.24,456.423 1996.77,486.872 2010.77,521.711 2014.37,560.805 
  2007.91,603.925 1991.88,650.746 1966.94,700.845 1933.84,753.701 1893.44,808.708 1846.61,865.176 1794.28,922.348 1737.31,979.413 1676.58,1035.52 1612.86,1089.81 
  1546.85,1141.4 1479.19,1189.46 1410.41,1233.18 1340.95,1271.83 1271.17,1304.75 1201.38,1331.4 1131.81,1351.37 1062.67,1364.35 994.14,1370.22 926.414,1368.97 
  859.692,1360.77 794.215,1345.91 730.276,1324.85 668.23,1298.13 608.505,1266.43 551.604,1230.49 498.107,1191.14 448.662,1149.22 403.979,1105.59 364.807,1061.11 
  331.918,1016.61 306.085,972.834 288.05,930.49 278.499,890.184 278.036,852.424 287.149,817.612 306.197,786.042 335.381,757.9 374.735,733.266 424.118,712.125 
  483.208,694.381 551.506,679.868 628.346,668.371 712.908,659.639 804.235,653.414 901.25,649.439 1002.78,647.481 1107.59,647.347 1214.37,648.892 1321.82,652.028 
  1428.6,656.734 1533.41,663.046 1635,671.061 1732.17,680.927 1823.8,692.828 1908.89,706.971 1986.57,723.572 2056.08,742.834 2116.85,764.931 2168.42,789.986 
  2210.55,818.061 2243.13,849.137 2266.24,883.104 2280.08,919.753 2285.02,958.774 2281.52,999.751 2270.16,1042.17 2251.58,1085.42 2226.47,1128.82 2195.54,1171.62 
  2159.48,1213.01 2118.99,1252.17 2074.69,1288.27 2027.17,1320.5 1976.93,1348.09 1924.42,1370.35 1869.98,1386.66 1813.91,1396.51 1756.42,1399.53 1697.7,1395.46 
  1637.86,1384.21 1577.01,1365.81 1515.24,1340.43 1452.65,1308.4 1389.38,1270.16 1325.6,1226.24 1261.55,1177.31 1197.54,1124.06 1133.96,1067.28 1071.32,1007.78 
  1010.19,946.383 951.24,883.911 895.234,821.174 842.994,758.948 795.39,697.962 753.316,638.887 717.659,582.329 689.269,528.819 668.922,478.807 657.291,432.663 
  654.912,390.67 662.154,353.031 679.201,319.871 706.03,291.243 742.405,267.139 787.873,247.499 841.77,232.224 903.233,221.191 971.224,214.265 1044.55,211.314 
  1121.91,212.22 1201.89,216.887 1283.06,225.251 1363.96,237.281 1443.15,252.979 1519.28,272.378 1591.08,295.532 1657.4,322.508 1717.26,353.373 1769.85,388.178 
  1814.54,426.945 1850.91,469.652 1878.73,516.215 1897.95,566.48 1908.73,620.208 1911.36,677.071 1906.29,736.641 1894.08,798.394 1875.36,861.71 1850.82,925.876 
  1821.2,990.099 1787.21,1053.52 1749.55,1115.21 1708.88,1174.24 1665.77,1229.64 1620.77,1280.47 1574.32,1325.83 1526.8,1364.88 1478.49,1396.88 1429.63,1421.2 
  1380.41,1437.36 1330.96,1445.03 1281.38,1444.04 1231.78,1434.39 1182.25,1416.26 1132.92,1389.99 1083.96,1356.09 1035.57,1315.17 988.035,1267.99 941.693,1215.38 
  896.97,1158.25 854.363,1097.54 814.44,1034.19 777.837,969.164 745.234,903.364 717.346,837.653 694.897,772.822 678.588,709.586 669.083,648.569 666.964,590.3 
  672.715,535.215 686.687,483.652 709.075,435.861 739.901,392.007 779.008,352.187 826.022,316.428 880.407,284.722 941.398,257.017 1008.08,233.248 1079.37,213.346 
  1154.05,197.25 1230.8,184.915 1308.22,176.326 1384.9,171.497 1459.4,170.474 1530.35,173.335 1596.42,180.18 1656.44,191.125 1709.34,206.295 1754.25,225.803 
  
  "/>
<path clip-path="url(#clip800)" d="
M1988.57 198.898 L2280.81 198.898 L2280.81 95.2176 L1988.57 95.2176  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1988.57,198.898 2280.81,198.898 2280.81,95.2176 1988.57,95.2176 1988.57,198.898 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2012.55,147.058 2156.44,147.058 
  "/>
<path clip-path="url(#clip800)" d="M2194.26 166.745 Q2192.46 171.375 2190.74 172.787 Q2189.03 174.199 2186.16 174.199 L2182.76 174.199 L2182.76 170.634 L2185.26 170.634 Q2187.02 170.634 2187.99 169.8 Q2188.96 168.967 2190.14 165.865 L2190.9 163.921 L2180.42 138.412 L2184.93 138.412 L2193.03 158.689 L2201.14 138.412 L2205.65 138.412 L2194.26 166.745 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2212.94 160.402 L2220.58 160.402 L2220.58 134.037 L2212.27 135.703 L2212.27 131.444 L2220.53 129.778 L2225.21 129.778 L2225.21 160.402 L2232.85 160.402 L2232.85 164.338 L2212.94 164.338 L2212.94 160.402 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<h3 id="Solving-the-second-order-ODE-directly"><a class="docs-heading-anchor" href="#Solving-the-second-order-ODE-directly">Solving the second-order ODE directly</a><a id="Solving-the-second-order-ODE-directly-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-second-order-ODE-directly" title="Permalink"></a></h3><p>Instead of first transforming the problem, we can also solve it directly as a second-order ODE, by defining it as a <code>SecondOrderODEProblem</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>SecondOrderODEProblem</code> type is not defined in ProbNumDiffEq.jl but is provided by SciMLBase.jl. For more information, check out the DifferentialEquations.jl documentation on <a href="https://diffeq.sciml.ai/stable/types/dynamical_types/">Dynamical, Hamiltonian and 2nd Order ODE Problems</a>.</p></div></div><pre><code class="language- hljs">function Hénon_Heiles2(ddu, du, u, p, t)
    ddu[1] = -u[1] - 2 * u[1] * u[2]
    ddu[2] = u[2]^2 - u[2] - u[1]^2
end
prob2 = SecondOrderODEProblem(Hénon_Heiles2, du0, u0, tspan)
sol2 = solve(prob2, EK1());
plot(sol2, vars=(3, 4))</code></pre><h3 id="Benchmark:-Solving-second-order-ODEs-is-*faster*"><a class="docs-heading-anchor" href="#Benchmark:-Solving-second-order-ODEs-is-*faster*">Benchmark: Solving second order ODEs is <em>faster</em></a><a id="Benchmark:-Solving-second-order-ODEs-is-*faster*-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmark:-Solving-second-order-ODEs-is-*faster*" title="Permalink"></a></h3><p>Solving second-order ODEs is not just a matter of convenience - in fact, SciMLBase&#39;s <code>SecondOrderODEProblem</code> is neatly designed in such a way that all the classic solvers from OrdinaryDiffEq.jl can handle it by solving the corresponding first-order ODE. But, transforming the ODE to first order increases the dimensionality of the problem, and comes therefore at increased computational cost; this also motivates <a href="https://diffeq.sciml.ai/stable/solvers/dynamical_solve/">classic specialized solvers for second-order ODEs</a>.</p><p>The probabilistic numerical solvers from ProbNumDiffEq.jl have the same internal state representation for first and second order ODEs; all that changes is the <em>measurement model</em> [1]. As a result, we can use the <code>EK1</code> both for first and second order ODEs, but it automatically specializes on the latter to provide a <strong>2x performance boost</strong>:</p><pre><code class="nohighlight hljs">julia&gt; @btime solve(prob, EK1(order=3), adaptive=false, dt=1e-2);
  766.312 ms (400362 allocations: 173.38 MiB)

julia&gt; @btime solve(prob2, EK1(order=4), adaptive=false, dt=1e-2);
  388.301 ms (510676 allocations: 102.78 MiB)</code></pre><h2 id="Energy-preservation"><a class="docs-heading-anchor" href="#Energy-preservation">Energy preservation</a><a id="Energy-preservation-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-preservation" title="Permalink"></a></h2><p>In addition to the ODE given above, we know that the solution of the Hénon-Heiles model has to <em>preserve energy</em> over time. The total energy can be expressed as the sum of the potential and kinetic energies, given by</p><p class="math-container">\[\begin{aligned}
\operatorname{PotentialEnergy}(x,y) &amp;= \frac{1}{2} \left( x^2 + y^2 + 2 x^2 y - \frac{2y^3}{3} \right), \\
\operatorname{KineticEnergy}(\dot{x}, \dot{y}) &amp;= \frac{1}{2} \left( \dot{x}^2 + \dot{y}^2 \right).
\end{aligned}\]</p><p>In code:</p><pre><code class="language-julia hljs">PotentialEnergy(x, y) = 1 // 2 * (x^2 + y^2 + 2x^2 * y - 2 // 3 * y^3)
KineticEnergy(dx, dy) = 1 // 2 * (dx^2 + dy^2)
E(dx, dy, x, y) = PotentialEnergy(x, y) + KineticEnergy(dx, dy)
E(u) = E(u...); # convenient shorthand</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">E (generic function with 2 methods)</code></pre><p>So, let&#39;s have a look at how the total energy changes over time when we numerically simulate the Hénon-Heiles model over a long period of time: Standard solve</p><pre><code class="language- hljs">longprob = remake(prob2, tspan=(0.0, 1e3))
longsol = solve(longprob, EK1(smooth=false), dense=false)
plot(longsol.t, E.(longsol.u))</code></pre><p>It visibly loses energy over time, from an initial 0.12967 to a final 0.12899. Let&#39;s fix this to get a physically more meaningful solution.</p><h3 id="Energy-preservation-with-the-ManifoldUpdate-callback"><a class="docs-heading-anchor" href="#Energy-preservation-with-the-ManifoldUpdate-callback">Energy preservation with the <code>ManifoldUpdate</code> callback</a><a id="Energy-preservation-with-the-ManifoldUpdate-callback-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-preservation-with-the-ManifoldUpdate-callback" title="Permalink"></a></h3><p>In the language of ODE filters, preserving energy over time amounts to just another measurement model [1]. The most convenient way of updating on this additional zero measurement with ProbNumDiffEq.jl is with the <code>ManifoldUpdate</code> callback.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>ManifoldUpdate</code> callback can be thought of a probabilistic counterpart to the <a href="https://diffeq.sciml.ai/stable/features/callback_library/#Manifold-Conservation-and-Projection"><code>ManifoldProjection</code></a> callback provided by DiffEqCallbacks.jl.</p></div></div><p>To do so, first define a (vector-valued) residual function, here chosen to be the difference between the current energy and the initial energy, and build a <code>ManifoldUpdate</code> callback</p><pre><code class="language-julia hljs">residual(u) = [E(u) - E(du0..., u0...)]
cb = ManifoldUpdate(residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DiscreteCallback{ProbNumDiffEq.var&quot;#condition#36&quot;, ProbNumDiffEq.var&quot;#affect!#37&quot;{Int64, Float64, Float64, typeof(Main.residual)}, typeof(SciMLBase.INITIALIZE_DEFAULT), typeof(SciMLBase.FINALIZE_DEFAULT)}(ProbNumDiffEq.var&quot;#condition#36&quot;(), ProbNumDiffEq.var&quot;#affect!#37&quot;{Int64, Float64, Float64, typeof(Main.residual)}(100, 1.0e-25, 1.0e-15, Main.residual), SciMLBase.INITIALIZE_DEFAULT, SciMLBase.FINALIZE_DEFAULT, Bool[1, 1])</code></pre><p>Then, solve the ODE with this callback</p><pre><code class="language- hljs">longsol_preserving = solve(longprob, EK1(smooth=false), dense=false, callback=cb)
plot(longsol.t, E.(longsol.u))
plot!(longsol_preserving.t, E.(longsol_preserving.u))</code></pre><p>Voilà! With the <code>ManifoldUpdate</code> callback we could preserve the energy over time and obtain a more truthful probabilistic numerical long-term simulation of the Hénon-Heiles model.</p><h4 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h4><p>[1] N. Bosch, F. Tronarp, P. Hennig: <strong>Pick-and-Mix Information Operators for Probabilistic ODE Solvers</strong> (2022)</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Introduction to ODE Filters</a><a class="docs-footer-nextpage" href="../dae/">Differential Algebraic Equations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 21 October 2022 20:21">Friday 21 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
